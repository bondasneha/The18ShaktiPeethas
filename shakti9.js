const contentData = {
    history: `
        <h3>History</h3>
        <p>Such is the grandeur of the divine home of Mahakala, the lord of time, who thrones the Mahakaleswar temple of Ujjain. The temple is one of the revered 12 Jyotirlingas in the country, and the Maha Shiva Lingum at the temple is considered to be Swayambhu (born from itself).</p>
        <p>The beautiful temple has endured the perils of time and still emerged as a testament to the faith of Shiva devotees. You wonâ€™t get enough of the artistic excellence bouncing off its walls and the colossal idol of Lord Mahakal whose sight is a blessing in itself.</p>
        <p>Lakhs of Shiva Bhakts attend the famous Bhasma Aarti at the break of every dawn. From tales of miracles and unanswered mysteries to the unshakable faith of many, Mahakaleswarâ€™s Shikhar is witness to a lot of divine happenings.</p>
        <p>According to the ancient scripture Sthalapuranam, King Chandrasena was a devotee of Shiva. A young boy named Shrikhar heard his prayers to the god and wanted to join him. However, people did not let him do it, and sent him out of the city. Also, Shrikhar heard the plans of rival kings Ripudhamana and Singhaditya to attack the city with the help of the demon king Dushan.</p>
        <p>Moreover, Dushan had a blessing of invisibility from Brahma. So, Shrikhar and a priest named Vriddhi prayed to Lord Shiva for help. The enemies arrived at Avantika (Ujjain) and started torturing the people. They banned all Vedic Dharmanushtan activities in the city. The people started praying to Lord Shiva for help.</p>
        <p>Devotees also believe that when Dushan started attacking Avantika, the ground split near the statue of Parvati and Lord Shiva came out of it as Mahakaal. He burnt the demons with just one grunt. Adhering to the request of the people of Avantika, Lord Shiva then decided to stay there as the chief deity of Avantika.</p>
        <div align="center">
          <p><b>Appellation:</b> Ujjaini Pitham.</p>
          <p><b>Part of body fallen :</b> Upper lip.</p>
          <p><b>Name of shakti :</b> Mahakali(Mahakalai Devi).</p>
          <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        </div>
    `,
    significance: `
        <h3>Significance</h3>
        <p>ÂŸ It is believed that a visit to this temple can help one overcome the fear of death and the constraints of time.</p>
        <p>ÂŸ Spiritual Ujjain: Ujjain itself holds immense spiritual significance.</p>
        <p>ÂŸ The idol of Mahakaleshwar is known to be dakshinamurti, facing the South.</p>
        <p>ÂŸ Lord Mahakaleshwar resides in the sacred city of Ujjain, India and is the third Jyotirlinga.</p>
        <p>ÂŸ Prajapati Brahma himself established the first temple at the site. The coins recovered at Ujjain have the mark of Lord Shiva on them.</p>
        <p>ÂŸ According to several poetic texts, in the Paramara period, invaders destroyed the temple. Later, Udayaditya and Naravarman rebuilt it.</p>    
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p>ÂŸ On the day of Mahashivaratri, a huge fair is held near the temple, Thousands of pilgrims flock to the fair grounds near the Mahakaleshwar temple and do their worship throughout the night.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Ujjain,Madhya Pradesh<br>âœˆï¸ Nearest Airports: Indore Airport (58 KM)<br>ğŸš‰ Railway Station:  Ujjain railway station (1.3 KM)<br>ğŸ›£ï¸ Road ways: Jantar mantar(2.6 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ 3:00AM -11:00 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <p>Click down link to open official website of Mahankalai Temple</p>
      <center>
  <a href="https://shrimahakaleshwar.com/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Mahankalai Temple Website
    </button>
  </a>
</center>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>prasadam typically includes items such as bhaat (cooked rice), kadhi (a yogurt-based curry), puri (fried bread), sabzi (vegetable curry), and sometimes sweets like ladoo or peda. These prasadams are considered sacred and are offered to Lord Mahakaleshwar during puja rituals before being distributed to devotees as blessings.</p>
      <p>ÂŸ No facilities available.</p>
      <p>ÂŸ There are several accommodation options near the temple for devotees, such as lodges, hotels, and guest houses..</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>ÂŸ Pilgrims should also be mindful of the religious practices and customs observed at the Mahakaleshwar Temple.</p>
      <p>ÂŸ Photography is generally not allowed inside the sanctum sanctorum.</p>
      <p>ÂŸ And visitors should refrain from any behaviour that may disrupt the peaceful atmosphere or offend the religious sentiments of others.</p>
      <p>ÂŸ Devotees are not allowed to carry cameras, purse, bags etc. inside the temple.</p>  
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>    
      `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Ujjain,Madhya Pradesh</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1xGsmNX1WKUrfxKgYYmPtzaFM1lR4D7Y&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//23.1786218,75.7698967/@23.1786004,75.6874951,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750249427538!6m8!1m7!1sCAoSFkNJSE0wb2dLRUlDQWdJRFdxb205Vmc.!2m2!1d23.18303181752159!2d75.76853101409512!3f292.9024831267481!4f13.56947677996925!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/qh5-Yuo2Ls8?si=X9n_r-7NsucLWfpZ&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
      const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://apnayatra.com/wp-content/uploads/2022/05/Mahakal-Temple-Ujjain.jpg",
    caption: "Aerial View of Mahakaleshwar Jyotirlinga Temple"
  },
  {
    src: "https://upload.wikimedia.org/wikipedia/commons/7/7d/Mahakal_Temple_Ujjain.JPG",
    caption: "Mahakaleshwar Temple Front Entrance"
  },
  {
    src: "https://images1.livehindustan.com/uploadimage/library/2022/10/10/16_9/16_9_1/madhya_pradesh_news_shri_mahakal_lok_mahakaleshwar_temple_ujjain_smart_city_project_ujjain_jyoti_1665372600.jpg",
    caption: "Newly Developed Mahakal Lok Corridor"
  },
  {
    src: "https://etvbharatimages.akamaized.net/etvbharat/prod-images/1200-675-18433656-thumbnail-16x9-imgdff.jpg",
    caption: "Devotees Visiting Mahakaleshwar Temple Complex"
  },
  {
    src: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSSADSDTXa4nXhmt9aaAzl8RsYcckbrc_u9vId2GC6JChdcyI-qrjLYpccGt-vopDUHEXM&usqp=CAU",
    caption: "Evening View of the Temple Shikhar Illuminated with Lights"
  },
  {
    src: "https://www.pilgrimagetour.in/blog/wp-content/uploads/2023/09/Mahakaleshwar-Temple-History.jpg",
    caption: "Mahakaleshwar Temple - Jyotirlinga of Lord Shiva in Ujjain"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 23.1765;
const lon = 75.7885;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
