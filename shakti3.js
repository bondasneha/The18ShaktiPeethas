const contentData = {
    history: `
        <h3>History</h3>
        <p>The temple was built by a great devotee of Srunkhala Devi named Sage Rishyasringa.</p>
        <p>Rishyasringa was looked after by his father since his childhood and was never link with the outside world apart from his father. He did not have any exposure to the outside world because of which he was pure at heart and similar to an infant, who does not know of any worldly joy.</p>
        <p>On the other hand, Srunkhala Devi is a goddess depicts a woman in her post natal stage and bounded by the love for newborn. Rishyasringa had the pure heart to preach Devi and this is how he became a devotee of Srunkhala devi.</p>
        <p>Rishyasringa maharishi devotedly preached the Srunkhala goddess here and was blessed by her completely.</p>
        <p>One day upon receiving an order from the Goddess, the sage went to visit Shringheri in Karnataka. Srunkhala goddess accompanied the sage. After a time, Rishyasringa also acquired the power of Srunkhala in and around Shringeri hill.</p>
        <p>Srunkhala Devi, according to the facts, must have been existed in West Bengal, Hoogly. But, according to one story, a sage Rishyashringala brought the Goddess to Shringeri in Karnataka.</p>
        <p>The Door to Shrinkkhala Devi Temple That is Closed off to the Public.</p>
        <p>Just near the Pandua, there is another temple with the name of Haneshwari Devi, which is considered to be another Shaktipeeth. Based on the information collected, it is possible that the place had Srunkhala Devi temple there.</p>
        <div align="center">
          <p><b>Appellation:</b> Bhavatarini Pitham.</p>
          <p><b>Part of body fallen :</b> Part of stomach.</p>
          <p><b>Name of shakti :</b>  Maa Shrinkala(Shrunkala Devi).</p>
        </div>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <p> The word Shrinkhala has two meanings. The first one being, a Binding thread or Binding chain, the second meaning is, a cloth which is used by the postnatal women to tie their abdomen tightly.</p>
        <p>  According to the first meaning, the goddess is in bounded form. Of-course, Jaganmata is bound only to the lord Shiva (Satya). She removes all bonds attached to her devotees.</p>
        <p> In the second meaning the goddess is in postnatal stage ( Mother of a newborn baby), in this form, she will see the entire universe as her child. The devotees imagine him/ her as a newborn baby of Shrinkhala mata. A complete surrenderance (Saranagati) and Sishu bhava is required to worship her.</p>
        <p> Sri Srunkhala Devi temple is located in Pandua, Hoogly district, West Bengal, and dedicated to Goddess Durga.</p> 
        <p> The temple is believed to be around 1000 years old and has a rich historical legacy. However, the original temple was destroyed by a Muslim invader, and a minar (tower) was constructed at its location.</p>
        <p> However, if you visit the place now where the temple is said to be present, you will only see an Islamic minaret standing tall.</p>
        <p> Currently, there is no temple standing at the site of Shrinkala Devi. Only the remains of the temple can be observed near the minar of Bari Masjid. The temple’s ruins are under the custody of the Archaeological Survey of India (ASI).</p>
        <p> Srunkhala Devi Temple was built on the region where it is believed that the stomach of Sati fell.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    festivals: `
        <h3>Festivals</h3>
        <p> During the month of February, Mela Taala, a festival is celebrated about 30 days duration inside the premises of the minaret, attended by the Muslim and Hindu communities, which sees a gathering of around 1 lakh people.</p>
        <p>  The best season to visit the temple is Winter season.</p>
        <p> The best months to visit are September to February.</p>
        <p> Pilgrims can approach the Information Office located adjacent to Sri Sharada Temple main entrance.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location:  Pradmunyee (Pandua),West Bengal.<br>✈️ Nearest Airports: Netaji Subhash Chandra Bose International Airport (69 KM)<br>🚉 Railway Station: Kolkata railway station (67 KM) , Pandua railway station (1.9 KM) <br>🛣️ Road ways: kali mandir (1 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘 6 :00 AM  - 8:00 PM</p>
      <p> Pilgrims can approach the Information Office located adjacent to Sri Sharada Temple main entrance.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    best: `
      <h3>Best Time To Visit</h3>
      <p>  <b>Best Season:</b> Winter season.</p>
      <p> <b>Best Months:</b> September - February.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>While specific details about the prasadam served at this temple may vary, common offerings typically include items like cooked rice, fruits, coconut, sweets, and sometimes special regional delicacies. These prasadams are offered to the goddess Bhadrakali during puja rituals and then distributed to devotees as blessings.</p>
      <p> Pilgrims can approach the Information Office located adjacent to Sri Sharada Temple main entrance.</p>
      <p> Free meals facility available in the temple from 12-15PM to 2-30PM and evening 7-15PM to 8-30PM.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p> For men the dress code is Shirt & Trouser, Dhoti or Pyjamas with upper cloth.</p>
      <p> For women the preferred dress code is saree or half-saree with blouse or chudidhar with pyjama and upper cloth.</p>
      <p> Shorts, mini-skirts, middies, sleeveless tops, low- waist jeans and short-length T-shirts are not allowed.</p>
      <p> Entry to the temple site is restricted for security reasons, likely due to the historical significance of the area and the importance of preserving the archaeological remnants.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍Pradmunyee, West Bengal</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1lwIkt0BBWRwrEod4jM39u_BOvKIy84w&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//23.5133534,88.0311845/@23.5133317,87.9487829,12z?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="" width="800" height="500" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
`,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/eCa22DfES8A?si=PvWKJEzZ3TQQmdiG&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
`
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
  src: "https://temples.vibhaga.com/wp-content/uploads/2020/04/Shrinkala-Devi-Shakti-Peeth-Temple-5.jpg",
  caption: "Sacred view of Shrinkala Devi Shakti Peeth Temple"
},
  {
    src: "https://1.bp.blogspot.com/-Bj-zIDiSfQ0/UIqvWC_VOXI/AAAAAAAAFMM/3ooGGZRLY9Q/s640/525914_3530355853930_1123247603_3316329_847563394_n.jpg",
    caption: "Majestic view of Shrinkala Devi Temple from the entrance"
  },
  {
    src: "https://behindeverytemple.org/wp-content/uploads/2020/10/39505145.jpg",
    caption: "Sacred rituals being performed near the sanctum"
  },
  {
    src: "https://lightuptemples.com/wp-content/uploads/2022/12/IMG_20170425_171627.jpg",
    caption: "Temple illuminated during festival celebrations"
  },
  {
    src: "https://1.bp.blogspot.com/-MNERtE3sgMs/XimI3feOfAI/AAAAAAABea4/Hvz2FdbAQ5sc08XCCEVb4eLZ9N5IL-E6ACLcBGAsYHQ/s1600/IMG_20170323_090301.jpg",
    caption: "Morning darshan of the temple gopuram"
  },
  {
    src: "https://1.bp.blogspot.com/-Vahf0CmTDrY/XimI3uXTzaI/AAAAAAABebA/Xu2xIzrHfu8XKrutpeA-7HmsH1PmQCX8ACLcBGAsYHQ/s1600/2018-10-06.jpg",
    caption: "Divine atmosphere inside the temple premises"
  },
  {
    src: "https://1.bp.blogspot.com/-HX0w8UW0nkA/XimI56fCKmI/AAAAAAABebU/teGyB-q9O7EIMLZ3WHU01KePOnrehteswCLcBGAsYHQ/s1600/Photo1120.jpg",
    caption: "Devotees gathered during Shrinkala Devi Utsav"
  }
];

const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 25.292;
const lon = 82.999;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
