const contentData = {
    history: `
        <h3>History</h3>
        <p>In the ancient traditional sources of the Shankara Vijaya, the Sringeri Matha is mentioned.</p>
            <p>Legend has it that twelve years were spent by Sri Shankaracharya at this place. It is believed that before Sri Shankara left for the North, he appointed Viswarupa, who was his disciple, to succeed him with the spiritual title of Sureshvaracharya.</p>
            <p>Ever since the 8th century, the Sringeri Matha has been recording history. Sri Guru Charitra, which was a 15th century Marathi work, comprises of the lineage of gurus of this matha right up to Vidyaranya.</p>
            <p>Another famous legend says that one day while Adi Shankaracharya was roaming around the banks of the Tunga River he spotted an unusual sight of a cobra spreading its hood to protect a pregnant frog against the sunlight. Seeing the kindness of the cobra towards his natural enemy, he was besieged and decided to build a temple on this unique yet pure land. The scenic town of Sringeri has some legends and historical temples to boast about primarily why the Sringeri Sharada Peetha is celebrated here. </p>
            <p>This place, also known as Dakshinamnaya Sringeri Sharada Peetam, is one of the famous tourist attractions in Chikmagalur worth a visit.</p>
            <div align="center">
                    <p><b>Appellation:</b> Sharada Pitham.</p>
            <p><b>Part of body fallen:</b> Right hand.</p>
            <p><b>Name of shakti:</b> Maa Sharada Devi(Saraswathi Devi).</p>
                </div>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>   
    `,
    significance: `
        <h3>Significance</h3>
        <p> It has been the historic epicenter of Sringeri's annual Navaratri festival celebrations, as well as the chariot festival held in February or March every year. </p>
            <p> The temple also gives the site its name, with "Sarada peetha" meaning "seat of learning". The temple was renovated to its current form in 1916.</p>
            <p> One of the holiest and most important Hindu pilgrim centres, Sringeri was the site of the first of the four Peethas (centres) established by the great sage Adi Shankaracharya, the founder of the Advaita philosophy. Sringeri has the Sharadamba </p>
            <p> Temple dedicated to Sharadamba, Goddess of Learning and Wisdom. The temple is famed for the matchless beauty of the idol.</p>
            <p> Nearby is the Vidyashankara Temple which is an architectural marvel – its 12 sculpted pillars, each representing a sign of the zodiac, are placed so that the sun’s rays fall on each successively, in the order of the solar months.</p>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
            `,
    festivals: `
        <h3>Festivals</h3>
        <p> Every year for 11 days, the Navratri festival is celebrated in the temple with Shathachandi Homa Poornahuti which takes place on the day of Mahanavmi. A special Puja also takes place at the Sri Sharada shrine.</p>
                    <p> An offering is also conducted for Sri Sharadambal on Vaisaka Krishna Prathipath Mahabhishekam.</p>
                    <p> A Deepotsava is organized in the Sri Sharada Shrine on Karthika Poornima Day. Lalitha Panchami too is celebrated along with a special Puja which is performed on the Magha Shukla Panchami to Sri Sharadamba by the Jagadguru. 
                    <p> Also, a special Puja takes place on both Magha Krishna Dwithiya and Magha Trithiya.</p>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
            `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location: Sharda, Kashmir,Pakistan Administered Kashmir<br>✈️ Nearest Airports: Mangalore Airport (105 KM) <br>🚉 Railway Station: Shimonga railway station (103 KM) <br>🛣️ Road ways: Narasimharajapura (50 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘 8:30 AM - 7:00 PM</p>
      <P> The ideal time to visit the temple is from October to April since the climate is perfect to explore and visit the place.</P>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <center><p>Click down link to open official website of Saraswathi Devi Temple</p></center>
      <center>
  <a href="https://sringeri.net/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Saraswathi Devi Temple Website
    </button>
  </a>
</center>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
   <p><b>Prasadam:</b>prasadam offerings may include cooked rice, dal (lentils), vegetable curry, puri (fried bread), sweets like ladoo or peda, and sometimes fruits or coconut. These prasadams are offered to the goddess Sharada during puja rituals and then distributed to devotees as blessings.</p>
                <p> In order to have a comfortable stay at Sringeri and have the darshan of Goddess and Acharya, Sri Sharada Peetham, Sringeri,   constructed  the  Guest houses near the  Sharada Temple.</p>
                   <p> devotees not on commercial basis but for their comfort.  Hence a minimum Kannikai is collected from the devotees for the usage of the guest houses in order to maintain the electrical and other amenities. </p>
                    <p> Further there are dormitory system to accommodate a group of devotees in one hall. </p>
                   <p> The Guest houses are allotted to the pilgrims/devotees on first come-first serve  basis.</p>  
                    <p> Advance booking of the guest house is not entertained.  For the requirement of Guest House, Pilgrims can approach the Information Office located adjacent to Sri Sharada Temple main entrance.</p>
                    <p> To cater the need of  devotees a big dining hall namely ‘Sri Bharathi Theertha Prasada’  has been built  near  Sri Sharada Temple, Sringeri  and Nitya Annadana is served to the all devotees in the afternoon and night  between 12.15 P.M. and 2.30 P.M.  and  7.15 P.M.  and  8.30 P.M. respectively.  Nitya Annadana is served for almost 7500 people which includes many schools and colleges, hospitals, etc.</p>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
            `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <P> For men the dress code is Shirt & Trouser, Dhoti or Pyjamas with upper cloth.</P>
                    <P> For women the preferred dress code is saree or half-saree with blouse or chudidhar with pyjama and upper cloth.</P>
                    <P> These rules are applicable for foreigners also. Shorts, mini-skirts, middies, sleeveless tops, low- waist jeans and short-length T-shirts are not allowed.</P>
                    <P> Pilgrims/visitors will not be allowed inside the temple if dress code is not followed.</P>
                    <P> Do respect ancient customs and co-piligrims while at temple.</P>
                    <P> Smoking is strictly prohibited inside the temple premises.</P>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
            `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍Sharda, Kashmir,Pakistan Administered Kashmir</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1chQxcYVhZnA78W6Q_iqLu013GM9ZMv0&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//34.7920875,74.1899531/@34.7920597,74.107552,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750253510185!6m8!1m7!1sCAoSFkNJSE0wb2dLRUlDQWdJQ1ptcmUtVEE.!2m2!1d34.79208433324278!2d74.18999336083246!3f89.85348279821295!4f7.149182488731768!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/5EUChg-q9S0?si=-Jm2Ocg8Q8VUtBIL&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
   const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
                  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://kashmirobserver.net/wp-content/uploads/2022/05/sharda-peeth.jpg",
    caption: "Sharda Peeth - Ancient Heritage Site"
  },
  {
    src: "https://thesouthfirst.com/wp-content/uploads/2022/10/WhatsApp-Image-2022-10-08-at-10.11.39.jpeg",
    caption: "Sharda Peeth Scenic Background"
  },
  {
    src: "https://images.news9live.com/wp-content/uploads/2023/03/Sharda-Peeth.jpg",
    caption: "Ruins of Sharda Peeth"
  },
  {
    src: "https://swarajya.gumlet.io/swarajya/2018-10/bddf094c-91e2-401c-b7ae-a67fd6ea22cd/ae9630ab_8db6_4fd2_9484_ea8dee216c30.jpg",
    caption: "Sharda Temple on the Line of Control"
  },
  {
    src: "https://feeds.abplive.com/onecms/images/uploaded-images/2023/01/20/c6e07a599be44256deefc8e23285b0fb1674229880191296_original.jpg",
    caption: "Sharda Peeth Historical Pillars"
  },
  {
    src: "https://th.bing.com/th/id/OIP.69zNRwCRloT8p9nwZZ76uQHaJQ?rs=1&pid=ImgDetMain&cb=idpwebpc2",
    caption: "Shrine View - Sharda Devi Temple"
  },
  {
    src: "https://hinduismtoday.b-cdn.net/wp-content/uploads/2023/12/Sharada-Temple-Teetwal-2.jpg",
    caption: "Scenic Shot of Sharda Temple Complex"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 18.8753;
const lon = 77.9488;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
