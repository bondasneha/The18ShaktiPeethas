const contentData = {
    history: `
        <h3>History</h3>
         <p>The temple is peculiar in that there is no statute of any deity in this temple, rather, there is a wooden carriage or doli which is worshipped.</p>
                <p>The origin of the name, Alopi (disappeared) Bagh lies in the Hindu belief that after the death of his wife Sati, the grieving Lord Shiva traveled through skies with her dead body.</p>
                <p>Lord Vishnu, to relieve him from this agony, threw his Chakra at the corpse, resulting in the fall of various parts of the body at various places in India, which were sanctified by the touch of the Goddess" body parts and hence were thereby deemed holy places for pilgrimage. The last part fell at this location thereby named Alopi and the holiest of all.</p>
                <p>As per some historical evidences, Great Maratha Warrior Shreenath Mahadji Shinde had developed the Sangam place during his stay at Allahabad in 1772 AD. Maharani Bayzabai Scindia has done some works for the renovation of Sangam ghats and temples at Allahabad.</p>
                <div align="center">
                    <P><b>Appellation:</b> Prayaga Pitham.</P>
                <P><b>Part of body fallen:</b> Fingers.</P>
                <P><b>Name of shakti:</b> Maa Madhaveswari(Madhaveshwari Devi).</P>
                </div>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P> It is believed that the last part of Sati Devi's body part fell at this location and she disappeared from the earthly realms, hence named Alopi (means disappeared). </P>
                <P> Also believes that it is the spot where 'Fingers' of the Devi Sati fell. The majority of locals consider Alopi Devi as their guardian deity.</P>
                <P> This holy site attracts huge crowd of Hindu devotees every day as well as during Navratri. Thousands of people living in the area keep coming to worship and have darshan of Alopi Devi. </P>
                <P> Along with him, on auspicious occasions like every festival, marriage, birth, they also come to take the blessings of the mother. </P>
                <P> It is named after Goddess Alopshankari. There is a platform in the middle of the temple courtyard where a pool is made. </P>
                <P> Above it is a special hammock or cradle, which is kept covered with red cloth.</P>
            <P> Alopi Devi Mandir is an ancient temple located in Alopi Bagh locality of Allahabad, Uttar Pradesh. Situated near Triveni Sangam.</P>
            <P> This distinguished Temple is positioned very close to the sacred Sangam Ghats where three holy Rivers- Ganges, Saraswati and Yamuna meet.</P>
            <P> Kumbh Mela is observed every four years to pay homage to god and to get blessings in bulk.</P>
            <P> Inside the main sanctum- sanctorum, there is no idol placed; only a Palki or the Doli is fixed in the center of the Temple Dome.</P>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
            `,
    festivals: `
        <h3>Festivals</h3>
        <P> Festivals such as Maha Shivratri, Chaitra Navratri, Shardiya Navratri, Dussehra, Durga Puja, and Diwali are celebrated in a grand enthusiasm.</P>
                <P> Kumbh Mela is the star attraction here and it attracts a crowd in exorbitant numbers, both domestic and international as well.</P> 
                <P> It is celebrated after a gap of every 12 years and on this auspicious period, people take bath in the holy water of Sangam.</P>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location:  Prayagraj,Uttar Pradesh<br>✈️ Nearest Airports: Prayagraj Airport (17 KM) <br>🚉 Railway Station: Allahabad railway station - (5 7 KM) <br>🛣️ Road ways: Anand Bhawan Museum (3.1 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘 12:00 AM - 11:59 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
    <P><b>Prasadam:</b>prasadam typically includes items such as cooked rice, dal (lentils), vegetable curry, puri (fried bread), kheer (rice pudding), and sometimes special sweets like peda or ladoo. These prasadams are offered to the goddess Alopi Devi during puja rituals and then distributed to devotees as blessings.</P>
        <P> There are several accommodation options near the temple for devotees, such as lodges, hotels, and guest house</P>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p> Dress modestly</p>
      <p>  Remove footwear before entering</p>
      <P> Alcohol and tobacco products are prohibited</P>
      <P> Please maintain decorum inside the temple and follow the dress code.</P>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍 Prayagraj,Uttar Pradesh</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1xDCiUY3_JjyHU4_hU6Uom1UKaNoJ2Jc&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//25.4443109,81.8705127/@25.4442879,81.7881112,12z/data=!3m1!4b1?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750252723652!6m8!1m7!1s5cOcrgHAtL6lDKmPX0HNug!2m2!1d25.44424305460909!2d81.87070243158233!3f113.9190814484783!4f4.658548934672467!5f0.4000000000000002" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/IOTIOFtrQ3Y?si=lMaXC_cCKFXY9wSX&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
    textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
      const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiR00gzcfrp8N-cCXdwdpG12FsnYY-9TG1b1P7pUTKQsaewl1fXPNUrBdYumPRUxtjUOfT0O57yTkFwMybLpp_dvzBXwfIEND6M4Sv7p3PEFbI3jIA-S_AeTKtcONWyugHeIWsKABw1RR4e/s1600/EAjOoFWU4AA8vAG.jpg",
    caption: "Holy View of Sangam Ghat – Prayagraj"
  },{
    src: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEWL60lK8xUPuXI-Jy4_eyG89tEn83iqlJ7_IT4sS2p18IK_e5fClebGExHKq0UNBVkKZcYdzXLNqMRcJRA3Z26CxLyfZBr3qhvtx7Fq6a6h5OwNlTKM5ttpVY31EdKJftf6gzeaFXugab/s1600/pm-modi_1544979175.jpeg",
    caption: "Pilgrimage Visit by Prime Minister Modi"
  },
  {
    src: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiLYRrfXcE3z5PMnf_ccMKxYVWFkfKT__o6OPzDY7H0KHf3nuLC1E2YDK4UAtX0_e6-2itLduaNa5e0TIuAhhGvT9ERiiWNJlsHm7s1ykJcYcENnUVp6B-au2KLhsYQu6T8VOD6ANGgWxG3/s1600/sri-mankameshwar-temple_1412842319.jpg",
    caption: "Sri Mankameshwar Temple near Triveni Sangam"
  },
  {
    src: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjXp-U7oHyzYZNDYeRrh67Dugj_ioOqTYBJ_81tL0tppPN6b8fuBTNzuTn0imh8eoZhHRcs5nuq48cA_B9t55W0bZyOOZKKyyP1yXY3JYT0Fw9zmMzAmN1XXdJWFxDycyUSGkmFh_o4BWXi/s1600/madhaveswari+Devi.jpg",
    caption: "Idol of Maa Madhaveswari Devi"
  },
  {
    src: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg3Gczx7H3L1n-9QG0tMYzgGd1ftawtQee_WHKMfWeygpy0C615twbgStUJCjoZtjqh4Iy8Sxd5DmFyPQOH2k1zIWbmTm6k7o7hQwi8iAIa6MX_URZCbpkQC1IN4MzK89HhtvmTNTvzy-I_/s1600/allahabad-triveni-sangam-14892481175-orijgp.jpg",
    caption: "Triveni Sangam – Confluence of Sacred Rivers in Prayagraj"
  }
];


const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 25.4358;
const lon = 81.8463;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
