const contentData = {
    history: `
        <h3>History</h3>
            <p>The daughter of King Daksha (Son of Lord Brahma) Sati, married Lord Shiva against the wishes of her father. Once Daksha organized a yajna in which everybody except Sati and Shiva was invited.</p>
            <p>Adamant to attend the Yajna held by her father, she proceeded alone against the wishes of Shiva. To her surprise, she was humiliated and disrespected by her father. Listening to the insults of her husband Shiva by her father, she became furious. She blamed herself for her husbands’ disrespect, so in rage and about her fathers’ wrongdoing, she immolated herself.</p>
            <p>Grief-stricken, and ferocious at the loss of Sati, Lord Shiva picked up the charred body on his shoulders and began the tandava.</p>
            <p>Tandava is known as the dance of destruction, and it was a threat to the entire universe. The Gods panicked and appealed to Lord Vishnu to intervene as Shiva gave up on his responsibilities and duties.</p>
            <p>The Gods and the Goddesses feared that Shiva would destroy the universe in his rage. So, Lord Vishnu intervened, and with his chakra, he severed the body of Sati into multiple pieces.</p>
            <p>The body parts of Sati fell on numerous places, and wherever the body parts fell, those places were converted into holy shrines by devotees. The holy places with the parts of Sati have now been converted into temples, by devotees, over the years. The temples are now known as Shaktipeethas.</p>
            <p>The Chamundeshwari temple is one of the 18 Maha Shaktipeethas. It is believed that the hair of Sati Devi fell here when Shiva outraged in anger and distress carried her charred body on her shoulders. The Chamundeshwari Devi Shaktipeetha is known as Krouncha Pitham, as in olden times, the place was known as Krouncha Puri.</p>
            </div><div align="center">
              <p><b>Appellation:</b> Krouncha Pitham.</p>
              <p><b>Part of body fallen:</b> Hair.</p>
              <p><b>Name of shakti:</b> Chamundeshwari (Chamundeshwari Devi).</p>
            </div>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
          <p> While going for the Chamundi hilltop, you get to see a gigantic idol of Mahishasura, and there is a story behind the connection between the Mahishasura and Chamundeshwari Devi. As the tales say, Mahisha Asura stands tall at the top of the 1,000 mt. tall hill, where the Devi slew him.</p>
          <p> The statue you come across while climbing up to the top of Chamundi hill is of Mahishasura, carrying a snake and a sword.</p>
          <p> The Chamundi Devi is known for her strength, courage, and divine quality of triumphing over the evil powers of the Asuras. She destroyed Mahisha Asura, and the won the battle by cutting off his head.</p>
          <p> The famous Chamundeshwari Temple is located at the top of Chamundi hills, Karnataka, 13 kms from the Mysore Palace.</p>
          <p> It has been named after the Goddess Durga, a fierce form of Shakti or power.</p>
          <p> This holy place has a unique significance to it as it has been built at the site where Satis’ hair fell.</p>
          <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p> Navaratri</p>
        <p> In the month of Ashadha, Fridays are considered particularly auspicious. Lakhs of devotees throng the temple during this occasion. Another festival celebrated during this month is Chamundi Jayanti.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>
  📍 <strong>Location:</strong> Mysuru (Mysore), Karnataka<br>
  ✈️ <strong>Airport:</strong> Mysuru Airport – <b>12 km</b><br>
  🚆 <strong>Railway Station:</strong> Mysore Junction – <b>5.9 km</b><br>
  🚌 <strong>Nearby Landmark:</strong> Regional Museum of Natural History – <b>2.1 km</b><br>
  🚍 <strong>Bus Service:</strong> KSRTC buses available every <b>20 minutes</b> from Mysuru city bus stand to <b>Sri Chamundeshwari Temple</b>
  <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
</p>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘 Morning: 7:30 AM - 2:00 PM<br>🕓 Afternoon: 3:30 PM - 6 :00 PM <br>🕓 Evening: 7:30 PM - 9:00 PM</p>
      <p>   <b>Abhisheka Timings:</b> 6:00 AM to 7:30 AM and 6:00 PM to 7:30 PM | Friday 5:00 AM to 6:30 AM.</p>
      <p>  <b>Darshana and Pooja Timings:</b> 7:30 AM to 2:00 PM and 3:30 PM to 6:00 PM and 7:30 p.m to 9 PM.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <p>Click down button to open official website of Chamundeshwari Devi Temple</p>
      <center>
  <a href="https://chamundeshwaritemple.in/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Chamundeshwari Devi Temple Website
    </button>
  </a>
</center>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>The prasadam served at this temple often includes items like puliyogare (tamarind rice), sweet pongal (a sweet rice dish), chakkuli (a savory snack), kadubu (steamed dumplings), and various types of sweets like laddu and mysore pak. These prasadams are considered sacred and are offered to the deity before being distributed to devotees as blessings.</p>
      <p> Dasoha (free meals) is arranged to devotees daily Morning - 7.30 a.m to 10 a.m, Noon - 12 p.m to 3.30 p.m, Night - 7.30 p.m to 9 p.m.</p>
      <p> For the convenience of devotees, the Mysore Chamundi Temple provides accommodation facilities within the temple premises. The temple offers various types of rooms, including dormitories, double rooms, and suites, to suit the needs and 
            budgets of different visitors. To make the booking process hassle-free, the temple has introduced an online booking system.</p>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>For men the dress code is Shirt & Trouser, Dhoti or Pyjamas with upper cloth. For women the preferred dress code is saree or half-saree with blouse or chudidhar with pyjama and upper cloth.</p>
      <p> Pilgrims/visitors will not be allowed inside the temple if dress code is not followed(Dress modestly).</p>
      <p> Sri Chamundeshwari Temples are declared as NO PLASTIC ZONE. Devotees are requested not to bring the plastic carry bags and not throw the plastic wastes in the hill area.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍 Mysuru (Mysore), Karnataka</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1ORQUCiPHHHBGvy2AoGvcWTLZbSYbxXQ&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//12.2725072,76.6707214/@12.2724949,76.5883195,12z?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750246752329!6m8!1m7!1sCAoSFkNJSE0wb2dLRUlDQWdJQ0Vvdm1IV2c.!2m2!1d12.27248259977101!2d76.67109352559254!3f260.28!4f29.58!5f0.4000000000000002" width="800" height="500" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
`,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/NtR5eZplFlw?si=bsKmBE4ClCFgZKIx&amp;controls=0&amp;start=2" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
`
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://behindeverytemple.org/wp-content/uploads/2020/10/chamundeshwari-hero.jpg",
    caption: "Chamundeshwari Temple - Hero Shot"
  },
  {
    src: "https://i.pinimg.com/originals/b2/f5/94/b2f5947d586c814c52bc5c1641a23507.jpg",
    caption: "Chamundeshwari Temple Steps View"
  },
  {
    src: "https://get2knowindia.com/wp-content/uploads/2016/06/14044582361_63fbf8cab4_k.jpg",
    caption: "Wide View of Chamundi Hills Temple"
  },
  {
    src: "https://chamundeshwaritemple.in/images/M-about.jpg",
    caption: "Chamundeshwari Temple Official Image"
  },
  {
    src: "https://religionworld.s3.amazonaws.com/uploads/2017/09/chamundi6-1200x1200.jpg",
    caption: "Chamundeshwari Temple Steps View"
  },
  {
    src: "https://www.inditales.com/wp-content/uploads/2022/08/jwalamalini-temple-chamundi-hills.jpg",
    caption: "Jwalamalini Shrine near Chamundi Hills"
  },
  {
    src: "https://www.explorebees.com/uploads/Chamundeshwari%20Temple%20in%20Chamundi%20Hill%20(2).jpg",
    caption: "Chamundi Hill Temple - Scenic Angle"
  }
];

const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; 
const lat = 12.2774;
const lon = 76.6747;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
