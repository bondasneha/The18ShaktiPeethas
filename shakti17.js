const contentData = {
    history: `
        <h3>History</h3>
        <p>The roots of the Vishalakshi Temple trace back to the tragic tale of Sati, the daughter of Prajapati Daksha, who defied her fatherâ€™s wishes to marry Lord Shiva. </p>
                <p>The temple is believed to be a Shakti Pitha, a holy site where the earrings or eyes of Mata Sati fell. Satiâ€™s poignant story involves her self-immolation during a Yagya organized by her father, Daksha, after he intentionally excluded her and Lord Shiva. </p>
                <p>The temple was established where a fragment of Satiâ€™s body touched the ground.</p>
        <div align="center">
                    <p><b>Appellation:</b> Varanasi Pitham.</p>
                <p><b>Part of body fallen:</b> Nose.</p>
                <p><b>Name of shakti:</b> Maa Vishalakshi(Vishalakshi Devi).</p>
                </div>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
         <p>ÂŸ Devotees take bath in holy River Ganges and offer prayers to the Goddess.</p>
                    <p>ÂŸ Varanasi, a city that represents Shastanga (six-fold) yoga, houses six temple locations, including the holy River Ganga, the Vishwanath Temple, the Vishalakshi Temple, the Kala Bhairava Temple, the Dhudiraj Temple (dedicated to Lord Ganesha), and the Dandapani Temple (dedicated to Lord Shiva). </p>
                    <p>ÂŸ The Vishalakshi Temple is a focal point of spiritual energy, attracting devotees seeking the blessings of Goddess Vishalakshi.</p>
                    <p>ÂŸ Devotees visit this temple to seek fulfillment of the following:-</p>
                    <p>ÂŸ Salvation</p>
                    <p>ÂŸ Wealth</p>
                    <p>ÂŸ Relief from diseases</p>
                   <p> ÂŸ Purchase of vehicles</p>
                    <p>ÂŸ Gain Knowledge</p>
                    <p>ÂŸ Dedicated to Goddess Parvati, also known as Vishalakshi Maa or Vishalakshi Gauri, this revered temple holds profound significance in Hinduism.</p>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
         <p>ÂŸ Devotees flock to the temple in the evening of the fifth day of Navatri. </p>
                    <p>ÂŸ The yearly temple festival of Vishalakshi Temple is celebrated on Kajali Tij (Black Third), the third lunar day (tij) of the waning fortnight in Bhadrapada, the last month of the Indian rainy season.</p>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Varanasi,Uttar Pradesh<br>âœˆï¸ Nearest Airports: Lal Bahadur Shastri International Airport (26 KM)<br>ğŸš‰ Railway Station:  Varanasi junction (4.6KM) <br>ğŸ›£ï¸ Road ways: Ramnagar (8.7 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ All days:  6:00AM - 10:00PM<br>ğŸ•“ Evening: Saturday & Tuesday:  6:00 AM - 9:45 PM</p>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
    <p><b>Prasadam:</b>prasadam typically includes items such as kheer (rice pudding), puri (fried bread), sabzi (vegetable curry), sweets like ladoo or peda, and sometimes fruits. These prasadams are offered to the goddess Vishalakshi during puja rituals and then distributed to devotees as blessings.</p>
                <P>ÂŸ Varanasi being an important tourist destination for both pilgrims as well as other tourists features numerous economic hotels as well as luxury hotels and guest houses.</P>
                    <P>ÂŸ Hotel such as Taj Ganges, Hotel Surabhi International, Hotel Varanasi Ashok, Hotel De Paris, and Hotel M M Continental are all situated within a short distance from Kashi Vishwanath Temple.</P>
                    <P>ÂŸ Regular offerings include flowers, Ganga jal and clothes.</P>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
                `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <P>ÂŸ For men the dress code is Shirt & Trouser, Dhoti or Pyjamas with upper cloth.</P>
                        <P>ÂŸ For women the preferred dress code is saree or half-saree with blouse or chudidhar with pyjama and upper cloth.</P>
                        <P>ÂŸ These rules are applicable for foreigners also. Shorts, mini-skirts, middies, sleeveless tops, low- waist jeans and short-length T-shirts are not allowed.</P>
                        <P>ÂŸ Pilgrims/visitors will not be allowed inside the temple if dress code is not followed.</P>
                        <P>ÂŸ Do respect ancient customs and co-piligrims while at temple.</P>
                        <P>ÂŸ Smoking is strictly prohibited inside the temple premises.</P>
                        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
                `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Varanasi,Uttar Pradesh</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1myCOGfEZisgfkpqgeftvDcrKODBwq5c&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//25.3099723,83.0119104/@25.3099494,82.9295089,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750253339815!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJRDQ2ckRWamdF!2m2!1d25.31004881087532!2d83.01207165924758!3f100!4f0!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/k_9NblnEFQw?si=IkoJSL50g6ch9KJP&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
    }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://kashiyatra.in/wp-content/uploads/2023/11/kashi-vishalakshi-temple-varanasi.jpg",
    caption: "Vishalakshi Temple Front View, Varanasi"
  },
  {
    src: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/13/ad/76/58/vishalakshi-temple.jpg?w=1200&h=1200&s=1",
    caption: "Vishalakshi Temple Courtyard"
  },
  {
    src: "https://i.ytimg.com/vi/10dLCseN1UA/hq720.jpg?sqp=-oaymwEXCK4FEIIDSFryq4qpAwkIARUAAIhCGAE=&rs=AOn4CLAb8GCb-TCC6dcg99Fniyy_l_n8KA",
    caption: "Vishalakshi Temple Ghat Side"
  },
  {
    src: "https://upload.wikimedia.org/wikipedia/commons/9/93/%E0%AE%95%E0%AE%BE%E0%AE%9A%E0%AE%BF_%E0%AE%B5%E0%AE%BF%E0%AE%9A%E0%AE%BE%E0%AE%B2%E0%AE%BE%E0%AE%9F%E0%AF%8D%E0%AE%9A%E0%AE%BF_%E0%AE%95%E0%AF%8B%E0%AE%AF%E0%AE%BF%E0%AE%B2%E0%AF%8D.jpg",
    caption: "Kashi Vishalakshi Temple - Tamil Inscription View"
  },
  {
    src: "https://www.alightindia.com/cdn/uploads/postimages/ORIGINAL/vishal1--e5109c.png",
    caption: "Vishalakshi Temple Detailed Carving"
  },
  {
    src: "https://1.bp.blogspot.com/-eQU3ndNSMr0/VTZTDoTFoKI/AAAAAAAAjhg/2GnHapDyutI/s1600/Side%2Bview%2Bof%2BAOL%2BVishalakshi%2Bmantap.jpg",
    caption: "Side View of AOL Vishalakshi Mantap"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 25.3109;
const lon = 83.0104;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
