const contentData = {
    history: `
        <h3>History</h3>
        <p>The temple which is dedicated to the goddess of bees, Bhramaramba Devi is on the River Krishna banks. Worshiped as Goddess Lakshmi, Bhramaramba Devi is the one who killed demon Arunasara and freed the people from his terror.</p>
        <p>Here the Goddess Bhramaramba Devi is worshiped in Brahmani Shakti form. The Goddess idol in the temple has eight arms, and she wears a silk sari. You can also see an idol of Lopamudra, who is the wife of saint Agastya at the templeâ€™s garbha griha. Sri Yantra is also there is garbha grihaâ€™s front.</p>
        <p>Kubham and Navratri are the famous festivals celebrated here with full enthusiasm. During your visit to the temple, you will learn about the various legendry stories of Goddess. The beauty of Nallamala hills and River Krishna also mesmerizes you.</p>
        <p>As Brahma signifies bee, you can also hear the beeâ€™s sound in the main templeâ€™s backside.</p>
        <p>As per ancient scriptures, once Lord Shiva and Parvatiâ€™s sons â€“ Ganesha and Kartikeya went into an argument that who among them is greatest and sought their parentâ€™s opinion.</p>
        <p>There were told to take rounds of the three worlds, and who comes back first will be the best of two. Soon Kartikeya went riding his peacock to take rounds of the three worlds. </p>
        <p>But Ganesha rides his mouse and started making Pradakshina (Circumambulation) of Devi Parvati and Lord Shiva. He said that touring his mother and father is equivalent to taking rounds of three worlds. Lord Shiva and Parvati, pleased with Ganeshaâ€™s words, declared him the winner.</p>
        <p>When Kartikeya returned and learned about the entire thing, he gets angry. Then he left Kailash and resides at Srisailam. Devi Parvati was not able to bear her sonâ€™s separation and goes behind his son to reside there. Soon Ganesha and Lord Shiva also reached Srisailam. Then Srisailam became the permanent place of stay of their entire family.</p>
        <div align="center">
          <P><b>Appellation:</b> Srisaila Pitham.</P>
          <P><b>Part of body fallen :</b> Neck.</P>
          <P><b>Name of shakti :</b> Bhramarambika(Bhramaramba Devi).</P><div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P>ÂŸ The templeâ€™s place is very divine, on the top of the Nallamala hills beside the river Krishna.</P>
        <P>ÂŸ It worships the deity Lord Mallikarjuna Swamy, who is considered one of the 12 Jyotirlingas of Lord Shiva. The vast compound area of the temple has divisions into two parts. One is for Lord Mallikarjuna, and another is for Goddess Bhramaramba.</P>
        <P>ÂŸ The temple holds the Jyotirlinga in immense holiness as worshippers consider it Swayambhu, meaning self-manifested. </P>
        <P>ÂŸ Lord Rama is believed to have consecrated the Sahasralinga within the temple. The Linga comprises 25 facets, symbolizing 40 Lingas. Additionally, it is widely believed that the Pandavas installed the Pancha Pandava Lingas in the temple, each bearing Sadyojatha, Aghora, Vamadeva, Tatpurusha, and Eesana.</P>        
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p>ÂŸ The <b>Dasara Mahotsavam</b> is one of the most important festivals celebrated. It is a time for devotees to come together and celebrate the victory of good over evil.</p>
        <p>ÂŸ <b>Kumbhothasavam</b> is the most significant festival various offerings are made to Goddess Bhramaramba Devi. This festival celebrates on the <b>first Tuesday or Friday</b> (which ever first comes) after full moon day of Chaitram, the beginning month of Indian Calendar.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Srisailam,Andhra Pradesh<br>âœˆï¸ Nearest Airports: Rajiv Gandhi International Airport (196 KM), Kurnool Airport (182 KM) <br>ğŸš‰ Railway Station:  Markapur- Railway station (84 KM) <br>ğŸ›£ï¸ Road ways: Srisailam Project Dam (14 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ Morning: 6:00 AM - 3:30 PM<br>ğŸ•“ Evening: 6:00 PM - 10:00 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <p>Click down link to open official website of Bhramaramba Devi Temple</p>
      <center>
  <a href="https://www.srisailadevasthanam.org/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Srisailadevasthanam Temple Website
    </button>
  </a>
</center>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>The prasadam served at this temple usually includes items such as cooked rice, tamarind rice, sweet pongal, various types of sweets like laddu and jaggery-based sweets, and sometimes savory snacks like murukku. These prasadams are offered to the deities during puja rituals and then distributed to devotees as blessings.</p>
      <p>ÂŸ Accommodation facilities are also good for devotees. Pilgrim Accommodation Complex: The Pilgrim Accommodation Complex near the temple premises provides affordable accommodation for devotees. These complexes consist of rooms and dormitories withshared facilities.</p>
      <p>ÂŸ Free food facility for devotees available.</p>     
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>     
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>ÂŸ No western clothes are allowed inside the temple premises.</p> 
      <p>ÂŸ Girls must cover their whole body by draping a Saree or by sporting any ethnic wear with a Duppatta for sure. Women are strictly prohibited inside the temple if they don't sport a duppatta or a saree. </p>
      <p>ÂŸ	And when it comes to Men, the same rule applies. No western clothes and no shorts allowed inside the temple. They must be traditionally dressed up in Kurta Pyjamas or Veshti or Shirt and Trouser to enter inside the temple for Darshan. These rules are to maintain the cultural decorum of the temple.</p>
      <p>ÂŸ Smart phones, or any kind of gadgets are strictly prohibited to take inside the main temple. They can be stored safely near the temple premises. Safety lockers are available for gadgets and luggage.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
      `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Srisailam,Andhra Pradesh</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1_WCmrqmj6IOqE6j3KYgQCByBq44k40c&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//16.0740381,78.86729/@16.0740223,78.7848882,12z?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750248705412!6m8!1m7!1sCAoSFkNJSE0wb2dLRUlDQWdJQ0U5Yy1qRUE.!2m2!1d16.07472798140444!2d78.86704889287489!3f61.82563617009963!4f10.261996896858278!5f0.5836883371136896" width="800" height="500" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
`,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/GOQRbP2MJ8g?si=XnOMja2EIfvSJUyj&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
`
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
      const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://i.pinimg.com/originals/54/63/09/5463093624ce1ce496a1dfb1b5810665.jpg",
    caption: "Historic Landscape of Srisailam Mallikarjuna"
  },
  {
    src: "https://www.todaystraveller.net/wp-content/uploads/2021/03/22-1-1140x694.jpg",
    caption: "Temple Corridor and Gopuram View"
  },
  {
    src: "https://assets-news.housing.com/news/wp-content/uploads/2022/09/10064214/Srisailam1.png",
    caption: "Temple Corridor and Gopuram View"
  },
  {
    src: "https://i.pinimg.com/originals/24/7c/5f/247c5f87edbe4f7e9626dedd53fee5cc.jpg",
    caption: "Golden Dawn at Srisailam Temple Complex"
  },
  {
    src: "https://hblimg.mmtcdn.com/content/hubble/img/srisailam/mmt/activities/m_Srisailam_Bhramaramba%20Devi%20Temple_1_l_480_640.jpg",
    caption: "TripAdvisor View of Mallikarjuna Swamy Temple"
  },
  {
    src: "https://media1.thrillophilia.com/filestore/4q2a6kti7gjnzotoidtl8ix0mhx9_1591622876_shutterstock_1009388653.jpg",
    caption: "TripAdvisor View of Mallikarjuna Swamy Temple"
  },
  {
    src: "https://www.astrojyoti.com/wp-content/uploads/2018/05/Srisailam-Temple.jpg",
    caption: "Temple Corridor and Gopuram View"
  }
];


const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}
const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 16.0726;
const lon = 78.8687;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}

let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
