const contentData = {
    history: `
        <h3>History</h3>
        <p>The construction work for the Draksharamam Bhimeswara Swamy Temple was started sometime in mid-800 A.D and subsequently completed in the 11th century.</p>
        <p>Several renovation works have been carried out and the temple was patronized by many royal dynasties. </p>
        <p>The temple is a protected Monument, with renovation and maintenance work being carried out by the Archeological Department of India. It is managed by the Executive Officer of the Endowments Department</p>
        <p>It is believed that when King Daksha the father of Lord Shiva’s consort, held a yagna, he deliberately insulted Shiva by not inviting him. Sati was so outraged with her father that she immolated herself in the sacrificial fire. When Shiva heard of this, he was infuriated and placing Sati’s body on his shoulder, he commenced the Tandava dance.</p>
        <p>The whole of creation came to a standstill by this Celestial event and the Gods appealed to Lord Vishnu to intervene. Vishnu then severed Sati’s body with his discus and the pieces fell to Earth. Draksharamam Bhimeswara Swamy was built on the spot where Sati’s left cheek is said to have fallen.</p>
        <div align="center">
          <p><b>Appellation:</b> Daksharama Pitham.</p>
          <p><b>Part of body fallen :</b> Left cheek.</p>
          <p><b>Name of shakti :</b> Manikyamba(Manikyamba Devi).</p>
          <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P> The Garbhaalaya or the Sanctum is replete with intricate decor and craftsmanship which represent the cultural grandeur of bygone eras. Constructed on an area of over 12 acres, the Draksharamam Bhimeswara Swamy Temple is surrounded by high walls and houses several shrines dedicated to various Gods within its premises.</P>       
        <P> The Draksharamam Bhimeswara Swamy Temple is located on the Kakinada Road in East Godavari District of Andhra Pradesh, India. </P>
        <P>  The temple has many significant features and is one of the few pilgrim centers where the female deity is given equal importance as the male.</P> 
        <P> It is a treasure trove of ancient inscriptions and epigraphs which are etched on the temple walls.</P>            
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <P> Maha Shivratri is celebrated with great enthusiasm in the month of February-March and people from all over the country make a beeline for a visit to this temple to witness the festivities on this auspicious day.</P>
        <P> Sri Swamivari Kalyanam on Bhishma Ekadasi is also a major festival which is celebrated with great fervor in the temple. Several other occasions are also celebrated here, especially the Shiva centric festivals.</P>
        <P> The entire complex literally vibrates with religious fervor on these occasions and devotees are immensely benefitted by the positive energy radiating in and around the vicinity of the shrine.</P>            
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location: Draksharamam,Andhra Pradesh<br>✈️ Nearest Airports: Rajahmundry Airport (63 KM)<br>🚉 Railway Station: Samarlakota railway station (39 KM) <br>🛣️ Road ways: Ramachandrapuram (6.8 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘 Morning: 7:00AM - 12:00 PM<br>🕓 Evening: 4:00 PM - 8:00 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>prasadam typically includes items such as cooked rice, tamarind rice, sweet pongal, various types of sweets like laddu and jaggery-based sweets, and sometimes savory snacks like murukku or chivda. These prasadams are offered to the deity Bhimeswara Swamy during puja rituals and then distributed to devotees as blessings.</p>
      <P> There are several accommodation options near the temple for devotees, such as lodges, hotels, and guest houses.</P>
      <P> Right in front of the temple, a choultry is also available. Here the devotees can relax for some time and also avail food, free of cost. </P>
      <P> Accommodations arealso available in near cities like Kakinada, Samalkota or Rajahmundry and from these areas, one can take a day trip via the bus to Draksharamam.</P>            
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p> Devotees must adhere to a rigorous dress code at the temple. </p>
      <p> Men are expected to wear traditional Indian attire, such as dhoti and kurta or pyjama and shirt. </p>
      <p> Women are expected to wear sarees or salwar kameez with a dupatta. Devotees are advised to dress modestly and avoid wearing shorts, skirts, or revealing outfits.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍Draksharamam,Andhra Pradesh</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1XnqY0cSKLlpHaXhpVdSkk-ydAiB5mDg&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//16.7928723,82.0633432/@16.7928559,81.9809414,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750252331987!6m8!1m7!1sMG76qPW_FNoil3q1xM2SNg!2m2!1d16.79262284517526!2d82.06315260079325!3f275.17574718615094!4f2.824275823693341!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/vREZjVsvUOg?si=DjojzMNJSGc4Anjd&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
    textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://upload.wikimedia.org/wikipedia/commons/7/7a/Draksharama_temple%2C_Draksharamam.jpg",
    caption: "Main Entrance of Draksharama Temple Complex"
  },
  {
    src: "https://i.pinimg.com/originals/20/45/a6/2045a6c4bb80399a989fde3493d2d803.jpg",
    caption: "Devotees Gather at Draksharamam Shakti Peetha"
  },
  {
    src: "https://i0.wp.com/sakalam.org/wp-content/uploads/2023/05/draksharamam-gopuram.jpg?fit=517%2C364&ssl=1",
    caption: "Goddess Manikyamba Idol at Draksharamam"
  },
  {
    src: "https://dakshinapatha.com/wp-content/uploads/2020/06/bhimeswara.jpg",
    caption: "Ancient Architecture of Bhimeswara Swamy Temple"
  },
  {
    src: "https://tse3.mm.bing.net/th/id/OIP.FZpaTcUli4N58gUUCmnukwHaJ4?rs=1&pid=ImgDetMain&o=7&rm=3",
    caption: "Inside View of Draksharamam Temple Premises"
  },
  {
    src: "https://content.jdmagicbox.com/comp/east_godavari/e2/9999px883.x883.141219134849.c1e2/catalogue/sri-bhimeswara-swamy-temple-draksharamam-east-godavari-temples-zaovm.jpg",
    caption: "Sri Bhimeswara Swamy Temple Exterior View"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 16.793;
const lon = 82.063;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
