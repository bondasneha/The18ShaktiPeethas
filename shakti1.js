
  const contentData = {
    history: `
      <h3>History</h3>
      <p>The Shankari Devi temple in Trincomalee has a deep history rooted in ancient Tamil culture and Portuguese invasion.</p>
      <p>The Portuguese colonists invaded the place and destroyed many places of worship in and around the Sri Lankan island after 1505 AD. On 14th April 1624, on Tamil New Year's Day, idols were taken on a procession through the town</p>
      <p>During this event, the Portuguese entered the temple dressed as priests and destroyed all the valuables in the temple. They even used a cannonball from their ship and plundered the top of the temple. The temple was destroyed, and the materials were used to make Fort Frederick. On the place of the temple, a lone pillar stood after that.</p>
      <p>The deities of Trikoneshwara and Shankari Devi were hidden in a well to protect them from Portuguese invaders and were recently recovered in Trino after the independence of Sri Lanka in 1948, from a well. The South Indian Chola ruler, Kulakottan, renovated the temple while some Buddhists maintained the design for the King Mahasena, who destroyed the temple and built in its place a Dagoba.</p>
      <p>Many artefacts from the demolished temple are preserved at the Lisbon museum. A stone inscription by Kulakottan had a dual fish emblem, and it said that after 1500 AD, the land would be ruled by people with different eye colors for at least 500 years, after which the earlier rulers, Vadugus, will get to rule the land.</p>
      <p>The inscription came out to be accurate, as Trincomalee was then ruled by the Dutch for around 500 years, followed by the Vadugus and the French until the Britishers captured Sri Lanka in 1795. A small temple was built in 1689 to preserve the idols, but no worshipping by the people was allowed. In 1952, a temple was also made for Trikoneshwara.</p>
      <p>Currently, there is a Shankari Devi temple that was built in 1952 by local Hindu Tamil people adjacent to which is the Trikoneshwar Temple. It was made after a long gap of 450 years. Near the temple, there is a sacred Bilva tree near the edge of the cliff on top of the Indian Ocean.</p>
      <div align="center">
        <p><b>Appellation:</b> Shankari Pitham.</p>
        <p> <b>Part of body fallen :</b> Groin (Thigh part).</p>
        <p><b>Name of shakti :</b> Maa Shankari (shankari Devi).</p>
      </div>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    significance: `
      <h3>Significance</h3>
      <p>This temple is considered one of the most ancient and spiritually important Shakti Peethas.</p>
      <p>ÂŸ The deity was being worshipped here more than 2500 years ago even before one of the first Kings, Prince Vijay, landed in Sri Lanka in 300 BC.</p>
      <P> ÂŸ It was one of the wealthiest temples in the South and had a large structure on the rock. </P>
      <p>ÂŸ Archaeological information states that there were three temples on the hilltop. </p>
      <p>ÂŸ The journey for pilgrims in the town begins at the opening of Konesar Road and follows a path through courtyard shrines of the compound to the deities Bhadrakali, Ganesha, Vishnu Thirumal, Surya, Raavana, Ambal-Shakti, Murukan and Shiva who presides at the promontory's height.</p> 
      <p>ÂŸ The annual Koneswaram Temple Ther Thiruvilah festival involves the Bhadrakali temple of Trincomalee, the Pavanasam Theertham at the preserved Papanasuchunai holy well and the proximal Back Bay Sea (Theertham Karatkarai) surrounding Konesar Malai.</p>
      <p>ÂŸ The tallest Gopuram with the Indian Ocean in its backdrop had the statue of the main deity. The temple was a massive structure with around 1000 pillars and small mandaps.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    festivals: `
      <h3>Festivals</h3>
      <p>Navaratri, Maha Shivaratri, and the Chariot Festival are celebrated with grandeur.</p>
      <p>ÂŸ The Ther Chariot Festival (Ratha yatra) lasts for twenty two days in April.</p>
      <p>ÂŸ The Tamil New Year. Navaratri lasts for nine days and is dedicated to various aspects of the presiding goddess.</p>
      <p>ÂŸ Sivarathri is dedicated to Siva. Devotees visit the temple to attend the daily pujas and make their offerings.</p>
      <p>ÂŸ The water-cutting Theertham Thiruvilah festival (holy bath) takes place annually in the centuries-old Papanasachunai holy well (Papanasam Theertham) on Swami Rock during the Ther festival period. </p>
      <p>ÂŸ The Koneswaram Poongavanam Festival the Temple Garden Festival is held during this twenty-two-day festival period.</p>
      <p>ÂŸ An annual three-day procession follows Maha Shivaratri Day.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Trincomalee, Sri Lanka<br>âœˆï¸ Nearest Airports: Bandaranaike (240 KM), Sigiriya (101 KM)<br>ğŸš‰ Railway Station: Trincomalee (3.1 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ Morning:6:00 AM - 1:00 PM<br>ğŸ•“ Evening:4:00 PM - 6:45 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>The prasadam served at this temple typically includes items such as coconut sweets, fruits, and cooked rice, which are offered to the goddess Shankari Devi and then distributed to devotees as blessings.</p>
      <p>ÂŸ Revenue from the temple provides services and food to local residents.</p>
      <p>ÂŸ AmaranthÃ© Bay Resort & Spa ,(4.5 Rating) 7.4 KM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>ÂŸ Dress modestly and respect the temple's rules and regulations.</p>
      <p> ÂŸ Remove your shoes before entering the temple premises.</p>  
      <p> ÂŸ Photography is not allowed inside the temple.</p>  
      <p> ÂŸ Carry a water bottle and wear comfortable shoes as the temple involves climbing stairs.</p> 
      <p> ÂŸ Visit the temple during the early morning or late afternoon to avoid the crowd and heat.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Trincoli, Srilanka</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1ZFue0n1DrF_vyhw41IUhggsSv1P_Kzo&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//8.5744291,81.2346568/@8.5744204,81.1522549,12z?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1749657088649!6m8!1m7!1sR6tYq8DlpfvoLeMiM7NkLg!2m2!1d8.574610289773819!2d81.23453503874549!3f146.14793!4f0!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/WwBbUjSb1dM?si=NtcYB1u0xw83JoCb&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
  const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
     window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://behindeverytemple.org/wp-content/uploads/2020/10/Untitled-Design-2020-10-03T111100.966.jpg",
    caption: "Behind Every Temple - Artistic Depiction"
  },
  {
    src: "https://th.bing.com/th/id/R.3aaf7ff861652e423d6d37a4b1b1a40d?rik=WMUI0Sswnd6R%2bg&riu=http%3a%2f%2f1.bp.blogspot.com%2f-J36EPUIWYPo%2fUIUydMWoE-I%2fAAAAAAAAE-o%2fsFpnjBxFDGU%2fs1600%2f168431_1750559760140_1123247603_2001512_2803290_n.jpg&ehk=NyjIlBXUP7y1TmrbbUn%2fgbXYKPlMjdNBFNt9EjtowHs%3d&risl=&pid=ImgRaw&r=0",
    caption: "Temple Idol Inside Shrine"
  },
  {
    src: "https://www.trawell.in/admin/images/upload/68587081Koneswaram_temple.jpg",
    caption: "Koneswaram Temple from Trawell.in"
  },
  {
    src: "https://www.urlaub-sr-lanka.info/wp-content/uploads/2023/07/muttumari-amman-hindu-temple-matale.jpg",
    caption: "Koneswaram Temple from Trawell.in"
  },
  {
    src: "https://th.bing.com/th/id/R.fbe2caea172c2c046ead34fe87aae507?rik=t0MFVpLT3CE4%2bw&riu=http%3a%2f%2f3.bp.blogspot.com%2f-XLaaXZN97rg%2fUoORzXaSdcI%2fAAAAAAAACG0%2fGLK5r3ca9yM%2fs1600%2fSL_sankari.jpg&ehk=JTPMa5BrZcgNZgO93rgymOVpuRIe%2bUv7cHR6qQtal5U%3d&risl=&pid=ImgRaw&r=0",
    caption: "Koneswaram Temple from Trawell.in"
  },
  {
    src: "https://srilankatravelpages.com/my_content/uploads/2021/09/bkqimgr9wpunzv45ohyj83tec6fdas0x-800x528.jpg",
    caption: "Koneswaram Temple from Trawell.in"
  },
  {
    src: "https://thumbs.dreamstime.com/b/trincomalee-sri-lanka-august-exterior-view-hindu-temple-pathirakali-amman-pathirakali-amman-temple-trincomalee-sri-lanka-134949164.jpg",
    caption: "Koneswaram Temple from Trawell.in"
  },
  {
    src: "https://srilankatravelpages.com/my_content/uploads/2023/04/History-of-Trincomalee.jpg",
    caption: "Koneswaram Temple from Trawell.in"
  },
  {
    src: "https://i0.wp.com/jetsettingduo.com/wp-content/uploads/2022/05/P1000913.jpg?resize=1700%2C1242&ssl=1",
    caption: "Jetsetting Duo Visit"
  }
];

const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 25.4432;
const lon = 81.8463;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
