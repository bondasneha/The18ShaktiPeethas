const contentData = {
    history: `
        <h3>History</h3>
        <p>The Kamakhya Temple is one of the oldest temples in the country and hence has a long and illustrious history associated with itself. It is believed that this temple was built during the Mleccha dynasty in 8th - 9th century. </p>
                <p>The Kamarupa Kings from Indra Pala to Dharma Pala were ardent followers of the Tantrik cult and at that time this temple became an important destination for Tantrikism.</p>
                 <p>The Kalika Purana was composed in the 10th century and it enhanced the importance of the temple as a seat for Tantrik sacrifices and sorcery.</p>
                <p>Mystic Buddhism or Vajrayana emerged here around that time and a number of Buddhist professors in Tibet were known to belong to Kamakhya.</p>
                <p>The Kamakhya temple was destroyed during Hussein Sha's invasion of the Kamata kingdom. The ruins remained undiscovered until the 1500s when the founder of the Koch Dynasty Vishwasingha revived the temple as a site of worship.</p>
                <p>The Kamakhya temple was reconstructed in 1565 during the reign of his son and ever since then, the shrine has been an important religious centre for Hindus across the world.</p>
                <p>While the Kamakhya Temple in itself is a highly revered site for all the followers of Hinduism; legend has it that during the month of Ashadh i.e. June according to the Gregorian Calendar, the Bramhaputra River that flows beside the temple turns red.</p>
               <p>It is believed that this is a divine phenomenon and that it happens because the Goddess menstruates during this time. While some people claim it is due to the high iron and Cinnabar deposits in the water, others continue to believe that it is a divine miracle! Thus, every year during the Ambubachi Mela, the river and the temple attracts thousands of devotees.</p>
        <div align="center">
                    <P><b>Appellation:</b> Kamarupa Pitham.</P>
               <P><b>Part of body fallen:</b>Womb.</P>
               <P><b>Name of shakti:</b> Devi Kamakhya(Kamarupa Devi).</P>
                </div>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P>ÂŸ It is one of the oldest and most revered centres of Tantric practices, dedicated to the goddess Kamakhya. </P>
                <P>ÂŸ The presiding deity, Devi Kamakhya, represents the power of femininity and fertility.</P>
                <P>ÂŸ The temple holds great importance for devotees seeking blessings for marital harmony, progeny, and overall well-being.</P>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
       <p>ÂŸ Ambubachi Mela is one of the biggest congregations of eastern India. It is the most important festival of the Kamakhya temple and is celebrated in the month of June every year.</p>
                <p>ÂŸ Durga Puja.</p>
                <p>ÂŸ Manasha Puja.</p>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>`,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Guwahati,Assam<br>âœˆï¸ Nearest Airports: Lokpriya Gopinath Bordoloi International Airport (20 KM) <br>ğŸš‰ Railway Station:  Guwahati Railway Station (8.1 KM) <br>ğŸ›£ï¸ Road ways: IIT Guwahati (19 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ Morning: 08:00 AM - 01:00PM<br>ğŸ•“ Evening: 02:30PM - 05:30PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <center><p>Click down link to open official website of Kamakhya Devi Temple</p></center>
      <center>
  <a href="https://www.maakamakhya.org/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Kamakhya Devi Temple Website
    </button>
  </a>
</center>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
    <p><b>Prasadam:</b>prasadam typically includes items such as kheer (rice pudding), sweets made from coconut and jaggery, various types of ladoo (sweet balls), and sometimes offerings of fruits and betel leaves. Additionally, special items like pitha (Assamese rice cakes) may also be served as prasadam. These prasadams are offered to the goddess Kamakhya during puja rituals and then distributed to devotees as blessings.</p>
            <P>ÂŸ The Assam Development Corporation has its own tourist home called as Lalita Kanta Yatri Niwas.
                <P>ÂŸ It offers excellent lodging as well as a food facility. While the cost of the rooms is moderate, all kinds of modern amenities are present for the visitors to use as well.</P>
                <P>ÂŸ Moreover, the presence of many luxuries and budget hotels is also present for travellers at the Nilachal Hills.</P>
                <P>ÂŸ From lodges to guest homes and a temple run guest house, visitors have lots of choices. One can also decide to put up at Guwahati and travel to the temple by availing public transportation like buses, auto-rickshaws and taxis.</P>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>ÂŸ Dress modestly</p>
      <p> ÂŸ Remove footwear before entering</p>
      <p>ÂŸ Cameras are allowed. </p>
                <p>ÂŸ Photography is not allowed inside the inner shrine</p>
                <p>ÂŸ Alcohol and tobacco products are prohibited</p>
                <p>ÂŸ Please maintain decorum inside the temple and follow the dress code.</p>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Guwahati,Assam</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1noVYQVj2xsc9vp2HB2P-44aNGN91TF4&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//26.1664108,91.7055031/@26.1663873,91.6231016,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750252470926!6m8!1m7!1sCAoSHENJQUJJaEFHYnl3NzZRUTJybWVySzlZQUJiZFg.!2m2!1d26.16641077340077!2d91.70550310674925!3f40!4f10!5f0.7820865974627469creen" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/LjkAOYq7yiA?si=F4aA5HAssWOqOeRM&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
    textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://rashminotes.com/wp-content/uploads/2019/06/g2.png",
    caption: "Kamakhya Temple - Sacred Hilltop View"
  },
  {
    src: "https://i.pinimg.com/474x/bd/ff/04/bdff0489412e8fadd5a8ac57e7713d93.jpg",
    caption: "Stone Architecture of Kamakhya Shakti Peetha"
  },
  {
    src: "https://static.toiimg.com/photo/50351123.cms",
    caption: "Kamakhya Temple during Festivities"
  },
  {
    src: "https://2.bp.blogspot.com/-Ot7JfJaKanA/ToBRZNN4B2I/AAAAAAAAAS0/m-HwIDAUjaY/s1600/Kamakhya+Temple2.jpg",
    caption: "Kamakhya Temple from Main Entrance Side"
  },
  {
    src: "https://i0.wp.com/newsriveting.com/wp-content/uploads/2023/10/WhatsApp-Image-2023-10-15-at-11.35.57_6bbbe0cb.jpg?fit=600%2C450&ssl=1",
    caption: "Kamakhya Mandir"
  },
  {
    src: "https://www.templeduniya.com/wp-content/uploads/2022/04/Untitled-min-3-1024x683-1.jpg",
    caption: "Devotees Gathered at Kamakhya Temple Premises"
  },
  {
    src: "https://eastindiantraveller.files.wordpress.com/2021/02/kamakhyatemple111-01.jpeg?w=1080",
    caption: "Kamakhya Temple Inner Sanctum Path"
  },
  {
    src: "https://bulbulonthewing.com/wp-content/uploads/2022/05/5_6102818455084336427-min.jpg",
    caption: "Overview of Kamakhya Temple Hillside Complex"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 26.1795;
const lon = 91.7539;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
