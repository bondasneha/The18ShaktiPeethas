const contentData = {
    history: `
        <h3>History</h3>
        <p>The original temple was grounded by Muslim invaders in 1390 CE. The temple was rebuilt after 615 years.</p>
        <p>Alampur was ruled by numerous South Indian dynasties like Rashtrakutas, Shatavahana Ishvakus, Badami Chalukyas, Kalyani Chalukyas, Vijayanagara Empires, Kakatiyas, and Qutub Shahis of Golconda.</p>
        <p>The interesting thing is that Muslim invaders established this ancient temple in the 1390 A.D. The army of Bahamani Sultan ruined the original temple of Jogulamba and Taraka Brahma in the 14th century.</p>
        <p>King Harihara asked his army to stop the attacks of the Sultan and secure the temple complex. After that, it was rebuilt after 615 years. It was then that the locals killed the invaders.</p>
        <div align="center">
          <P><b>Appellation:</b> Yogini Pitham.</P>
          <P><b>Part of body fallen :</b> Teeth.</P>
          <P><b>Name of shakti :</b> Jogulamba Thalli (Yogamba)(Jogulamba Devi).
        </div>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P> Jogini or Jogulamba – She is a female who has given abandoned all the earthly attachments.</P>
        <P> Yogulamba or Yogamba – She is a female dancer who dedicated her life to God.</P>
        <P> Jogulamba temple is one of the most famous religious centers in Telangana. It is considered as Dakshin Kasi. The Goddess Jogulamba is known as “Gruha Chandi,” which means the protector of our homes.</P>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p>The major festivals like:<br>Maha Shivaratri<br>Bramhotsavams <br>Dusshera are celebrated with high spirits. </p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>        
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location: Alampuram,Telangana<br>✈️ Nearest Airports: Rajiv Gandhi International Airport (203 KM), Kurnool Airport (56 KM) <br>🚉 Railway Station:  Kurnool City Railway Station (28 KM) <br>🛣️ Road ways: Kurnool District Toll Plaza (23 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘 Morning: 5:00 AM -1:00PM<br>🕓 Evening: 2:00 PM - 8:30PM</p>
      <P> Most of the pilgrims head to Jogulamba Devi Temple in February and March</P>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadams:</b>The prasadam served at this temple typically includes items such as cooked rice, tamarind rice, sweet pongal, chakkuli (a savory snack), and various types of sweets like laddu and jaggery-based sweets. These prasadams are offered to the goddess Jogulamba during puja rituals and then distributed to devotees as blessings.</p>
      <p> There are very little accommodation facilities available at Alampur Jogulamba temple. R&B Guest House present at the location is normally given to VIPs, if these houses are vacant, then only they are allotted to the normal tourists on rent basis.</p>
      <p> Haritha Hotel, Alampur is the place to rest for pilgrims, Located close to the Tungabhadra River, the hotel offers quality accommodation and food services.</p>
      <p> Pilgrims can stay at Kurnool, where many lodges are present offering good food and accommodation facility</p>      
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p> The Devotees should wear traditional dresses only.</p>
      <p> Male: Dhoti, Shirt / Kurtha, Pyjama.</p>
      <p> Female: Saree / Half Saree / Chudidar with Dupatta while visiting the temple for Darshanam.</p>
      <p> Devotees also required to bring printed copy of the receipt of Darshanam Tickets.</p>
      <p> Do respect ancient customs and co-piligrims while at temple.</p>
      <p> Smoking and drinking is prohibited in this temple.</p>
      <p> Chewing betel leaves, tobacco, gutka and spitting inside temple is strictly prohibited</p>  
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍Alampuram,Telangana</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/viewer?mid=1StFp6rGp8vE650PFJ-JtqZz4ENZWqg4&ll=15.877201895667115%2C78.13517781956763&z=19', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//15.8769909,78.1346258/@15.8769753,78.052224,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750248412611!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJREVfYU91N1FF!2m2!1d15.87768428892993!2d78.13563276403637!3f79.75!4f7.090000000000003!5f0.4000000000000002" width="800" height="500" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
`,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/n8msN6nJrio?si=gH7TZjhPBw_ttZw3&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
`
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
      const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://mahaavidya.org/wp-content/uploads/2024/01/Amma2.jpeg",
    caption: "Jogulamba Temple Entrance with Timings"
  },
  {
    src: "https://www.abhibus.com/blog/wp-content/uploads/2023/07/Alampur-Jogulamba-Temple-696x464.jpg",
    caption: "Local Guide's View of Jogulamba Complex"
  },
  {
    src: "https://behindeverytemple.org/wp-content/uploads/2020/10/Untitled-Design-2020-10-04T115530.429.jpg",
    caption: "Vibrant View of Jogulamba Temple"
  },
  {
    src: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg8Sd8YFpFMmFywCWiJFiQ-c-gcRODDncb4pObtjxvGe2KxxHp1Gu7tMYfbjFnN8VUvsVBMz7fJFKv2pLD4kfS01VDuT1IXBvpO-TvUyutG7hhb07c4hd7rgbB-wOnLB65H30Kv3TiXduY/s1600/IMG_20191229_170646.jpg",
    caption: "Jogulamba Devi Temple Front View"
  },
  {
    src: "https://www.templefolks.com/templefolks_admin/public/uploads/products/Jogulamba-Devi-temple-1890283.jpg",
    caption: "Jogulamba Temple Night Illumination"
  },
  {
    src: "https://www.templepurohit.com/wp-content/uploads/2015/11/184.jpg",
    caption: "Jogulamba Temple - Gadwal Overview"
  }
];


const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 15.878;
const lon = 78.132;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
