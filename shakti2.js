const contentData = {
    history: `
        <h3>History</h3>
        <p>The temple is also believed as the center of the earth or eastern hemisphere. There is a belief that after taking birth for killing Asur Bhandasur, Devi sat here taking â€œKanya Swarup.â€ The idol is â€œSwayambhu,â€ which signifies it has appeared and not created. She is believed to have three Swarups in the temple. These include Sthula, Sukshama, and Shunya.</p>
        <p>Goddess Kamakshi created the mud idol of Lord Shiva in Kanchi to worship him. To test her worship, Lord Shiva incarnated himself as Kamba River that has high tides. But the Goddess did not let the mud idol erode away in tides. She grasped it closely with her hands.</p>
        <p>She also prayed on a needle tip that is surrounded by 5 fires (Panchakagni) to free her from the livelihood interest. Lord Shiva became happy with her worship and married her.</p>
        <p>There are various Shiva temples in Kanchi, but â€œSri Kamakshi Amman Templeâ€ is the only one with the Goddess Sanctorum. Eight Shakti Goddesses also surround the temple.</p>
        <p>There was a standing image of Kamakshi Devi in Gold. This is a pose in which she prayed and is called Bangaru Kamakshi. An attack was expected at the temple, so the image in Gold gets shifted to Thanjavur.</p>
        <p>Lord Shiva and Vishnu surround Kamakshi temple situated in the heart of Kanchipuram. On one side, there are various Shiva temples and few Vishnu temples and is referred as big or Shiva Kanchi. The other side of the Kamakshi temple has big Vishnu temples and some Shiva temples too. This side is known as small or Vishnu Kanchi. </p>
        <div align="center">
          <p><b>Appellation:</b> Kamakoti Pitham.</p>
          <p><b>Part of body fallen:</b> Navel.</p>
          <p><b>Name of shakti:</b> Kamakshi Amman (Kamakshi Devi).</p>
        </div>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <p>ÂŸ The Kamakshi Amman Temple is known for its religious significance, stunning architecture, and rich history. Dedicated to Goddess Kamakshi, a divine form of Goddess Parvati, the temple holds immense spiritual importance for devotees.</p>
        <p>ÂŸ The temple's architecture showcases the artistic brilliance of the Pallava, Chola, and Vijayanagara dynasties, who contributed to its construction and expansion over the years. </p>
        <p>ÂŸ Additionally, the temple is famous for its daily aarti ceremonies and various religious services, which attract pilgrims and tourists alike.</p>
        <p>ÂŸ The place where Sri Kamakshi resides is known as â€œNabisthana Ottiyana Peetam.â€ Kamakshi refers to God that lives in Kanchi and Goddess Saraswati, and Lakshmi are her both eyes.</p>
        <p>ÂŸ Counted among one of the Shakti Peethaâ€™s, this is the place where the Navel or Nabhi of Goddess Sati fell when Lord Vishnuâ€™s Sudarshana Chakra touched Goddess Satiâ€™s body.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p>ÂŸ Navaratri</p>
        <p>ÂŸ Aadi and Aippasi Pooram</p>
        <p>ÂŸ Sankara Jayanthi and Vasanta Utsavam in the Tamil month of Vaikasi.</p>
        <p>ÂŸ All Fridays are considered sacred, though the Fridays in the Tamil months of Adi (mid-July to mid-August) and Thai (mid-January to mid-February) are celebrated. </p>        
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Kanchipuram,Tamil Nadu<br>âœˆï¸ Nearest Airports: Chennai International Airport(65 KM), Vellore Airport(77 KM) <br>ğŸš‰ Railway Station:  Kanchipuram railway station(1.2 KM) <br>ğŸ›£ï¸ Road ways: Mahabalipuram(69 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ Morning: 6:00 AM - 12:30 PM<br>ğŸ•“ Evening: 4:00 PM - 8:30 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <center><p>Click down button to open official website of Kamakshi Devi Temple</p></center>
      <center>
  <a href="https://kanchikamakshi.org/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Kanchi Kamakshi Temple Website
    </button>
  </a>
</center>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
    <p><b>Prasadam:</b>Some common prasadams served at the Kamakshi Amman Temple include tamarind rice (puliyodarai), sweet pongal (a rice and jaggery-based dessert), coconut rice, vadai (savory fried lentil fritters), and assorted sweets like ladoo and kesari. These prasadams are considered auspicious and are offered to the goddess Kamakshi before being distributed to devotees as blessings.</p>
    <p>ÂŸ Accommodation is provided to devotees visiting Shrimatam, Kanchipuram at the Yatri Nivas on Sri Kamakshi Amman Sannadhi Street (located very close to the Main Entrance of Sri Kamakshi Amman temple).</p>
    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>ÂŸ Dress modestly</p>
      <p> ÂŸ Remove footwear before entering</p>
      <p>ÂŸ Avoid photography inside the temple.</p>
      <p>ÂŸ Facilities Parking, restrooms, and drinking water facilities are available.</p>
      <p>ÂŸ Keep your noise levels to the minimum to maintain sanctity within the temple premises.</p>
      <p>ÂŸ Early morning is the best time to be here if you wish to avoid the crowds.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Kanchipuram,Tamil Nadu</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=17hF8fMs6f_UjY7n9PDGZVdXXBDquHGM&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//12.8406773,79.7031682/@12.8406645,79.6207663,12z/data=!3m1!4b1?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750244719292!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJRDRrcTJ5NXdF!2m2!1d12.84125901840747!2d79.70351408330318!3f302.81427!4f30!5f0.7820865974627469" width="800" height="500" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
`,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/J6SmjjHus8g?si=3coHYK6iqokB89oA&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
`
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
                    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }
  
  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://www.holidify.com/images/cmsuploads/compressed/A-beautiful-image-of-Kamakshi-Amman-Temple-pond-with-towers_20171219212102.jpg",
    name:"Serene view of Kamakshi Amman Temple pond with majestic gopurams"
  },
  {
    src: "https://i.pinimg.com/736x/37/78/8d/37788dc31ac549bfdb246b9d76671c78.jpg",
    name: "Kamakshi Devi - Idol Form"
  },
  {
    src: "https://thetempleguru.com/wp-content/uploads/2023/04/Kamakshi_Amman_Temple-12.jpg",
    name: "Kamakshi Devi - Idol Form"
  },
  {
    src: "https://jothishi.com/wp-content/uploads/2020/08/Kamakshi-Ambal-Temple-in-Kanchipuram-7-1024x1004.jpg",
    name: "Kamakshi Devi - Idol Form"
  },
  {
    src: "https://th.bing.com/th/id/OIP._sEEcXWIwCob1WMmCX33PQHaFS?pid=ImgDet&w=474&h=338&rs=1&cb=idpwebpc2",
    name: "Kamakshi Devi - Idol Form"
  },
  {
    src: "https://www.alightindia.com/cdn/uploads/postimages/ORIGINAL/kanchi1--c94058.jpg",
    name: "Kamakshi Temple Exterior"
  },
  {
    src: "https://i0.wp.com/mahaperiyavaa.blog/wp-content/uploads/2014/05/kamakshi_acharyas.jpg?fit=384%2C512&ssl=1",
    name: "Temple with Acharyas"
  },
  {
    src: "https://masalachilli.com/wp-content/uploads/2017/07/img_1925-scaled.jpg",
    name: "Devotees at Kamakshi Shrine"
  }
];

const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 12.4432;
const lon = 79.7032;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
