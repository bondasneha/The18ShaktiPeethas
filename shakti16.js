const contentData = {
    history: `
        <h3>History</h3>
        <p>The present temple dates back to 1459 CE and was built on a hill called Bhasmakoot Parvat. The entrance to the sanctum is very small and devotees have to crouch to enter. An â€˜Akhand Deepâ€™ is kept lit in the temple for all 24 hours.</p>
                <p>t is said that the highest of blessings are received just by the darshan of this Akhand Deep. This Akhand Deep has been burning since time immemorial and has never gone off. The sanctum also has beautifully carved sculptures on the walls.</p>
                <p>Just outside the sanctum is a hall (Mandap). Outside in the courtyard is a place where Homas and Havans are done. There are other shrines dedicated to Lord Ganesh, Hanuman Ji, and Mata Durga on the temple premises.</p>
                <p>Another shrine dedicated to Lord Shiva has a Shivling enshrined in the sanctum and Nandi outside.</p>
                <p>Mangala Gauri Temple is known for its miracles and devotees come with the greatest of expectations. Gaya is majorly a Vaishnavite center and this is one of the few temples of the Shaiva sect.</p>
                <P>It is also believed that a person can do his own after-death ceremonies (Shradh) whilst living in this temple. Also, Navratri is the main festival celebrated here. On Maha-Ashtami (the eighth day) there is a heavy rush of devotees.</P>
                <P>Meditation and prayer in this temple during Navratri give great benefits, according to devotees.</P>
        <div align="center">
                   <p><b>Appellation:</b> Gaya Pitham.</p>
                <p><b>Part of body fallen:</b> Breast. </p>
                 <p><b>Name of shakti:</b> Maa Sarvamangala(Sarvamangala Devi).</p>
                </div>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P>ÂŸ Mangala Gauri Temple in Gaya (Bihar) is yet another ancient Shaktipeeth. References to this temple can be found in various Puranas such as Padma Purana, Vayu Purana and Agni Purana. Besides this temple is mentioned in other religious texts too.</P>
                    <P>ÂŸ Mata Sati ended Her life after the insult of Lord Shiva in Daksha Prajapatiâ€™s Yagya. Her body was cut into 51 parts by Lord Vishnuâ€™s Sudarshan Chakra. The places where these body parts fell became Shaktipeeths.</P>
                    <P>ÂŸ It is believed the breast portion of Sati Mataâ€™s body fell at this spot. Magala Gauri Mata is known as the benevolent and loving Goddess. This temple is an â€˜Upa Shakti Peethâ€™, one of the 18 Maha Shaktipeeths.</P>
                    <p>ÂŸ It is a very old temple built in the 15th century. We have to climb up a small hillock to reach the temple.</p>
                        <p>ÂŸ The steps route is in between houses of local people. At the starting of steps route, there is the temple of Bhima (One of Five Pandavas).</p>
                       <p>ÂŸ We can see his knee impression here. Here Bhima did Shraddhakarma, hence called as Bhimvedi Gaya.</p>
                        <p>ÂŸ There are two minor shrines dedicated to Lord of lirds Parmeswar Shiva and images of Mahishasura Mardini, Durga, and Dakshina Kali.</p>
                        <p>ÂŸ The temple complex encompasses of temples of Maa Kali, Lord Ganesha, Lord Hanuman and Lord Shiva.</p>
                        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
                `,
    festivals: `
        <h3>Festivals</h3>
        <div align="center">
                    <P>Navaratri</P>
                </div>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>`,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Gaya,Bihar<br>âœˆï¸ Nearest Airports:  Gaya International Airport (8.6 KM) <br>ğŸš‰ Railway Station:  Gaya Junction  (4.8 KM) <br>ğŸ›£ï¸ Road ways: Manpur (5.2 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <center><p>ğŸ•˜ 6:00 AM - 8:00 PM</p></center>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
    <p><b>Prasadam:</b>prasadam typically includes items such as khichdi (a dish made with rice and lentils), puri (fried bread), sabzi (vegetable curry), sweets like ladoo or peda, and sometimes fruits. These prasadams are offered to the goddess Mangla Gauri during puja rituals and then distributed to devotees as blessings.</p>
                    <P>ÂŸ There are lots of hotels and lodges available around the temple for different price range. One can stay in Bodh Gaya as well.  </P>
                        <P>ÂŸ As this is very famous tourist place in Bihar, lots of Indian and continental restaurants are available around the temple. Both South Indian, North Indian and continental foods are available.</P>
                        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
                `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <P>ÂŸ For men the dress code is Shirt & Trouser, Dhoti or Pyjamas with upper cloth.</P>
                        <P>ÂŸ For women the preferred dress code is saree or half-saree with blouse or chudidhar with pyjama and upper cloth.</P>
                        <P>ÂŸ These rules are applicable for foreigners also. Shorts, mini-skirts, middies, sleeveless tops, low- waist jeans and short-length T-shirts are not allowed.</P>
                       <P>ÂŸ Pilgrims/visitors will not be allowed inside the temple if dress code is not followed.</P>
                        <P>ÂŸ Do respect ancient customs and co-piligrims while at temple.</P>
                        <P>ÂŸ Smoking is strictly prohibited inside the temple premises.</P>
                        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
                `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Gaya,Bihar</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1lhUd4ltZHEEDwuknF8Sm8SrpVdeNzH0&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//24.7750888,85.0023075/@24.7750663,84.919906,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750253187587!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJQ1g1TEw4Z2dF!2m2!1d24.77495635665534!2d85.00251083172718!3f243.492226086963!4f-3.542528122615394!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/hAUOQJXrN6o?si=XSIiYR5CO3MmeRbR&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
    textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
     const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://i.pinimg.com/564x/90/42/a7/9042a74f8dfc5ac4fe6ca62210f4f55d.jpg",
    caption: "Mangla Gauri - Evening Illumination"
  },
  {
    src: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/12/a5/cb/52/pano-20180412-081731.jpg?w=500&h=500&s=1",
    caption: "Panoramic View from Mangla Gauri Hill"
  },
  {
    src: "https://dynamic-media-cdn.tripadvisor.com/media/photo-o/0c/64/b6/19/the-vishupad-temple-of.jpg?w=500&h=500&s=1",
    caption: "Nearby Vishnupad Temple at Gaya"
  },
  {
    src: "https://i.pinimg.com/originals/75/4c/00/754c0059b1db822c753f7cc82019f129.jpg",
    caption: "Nearby Vishnupad Temple at Gaya"
  },
  {
    src: "https://temple.yatradham.org/public/Product/temple/temple_r5AFg4EE_202307171157490.webp",
    caption: "Devotees at Mangla Gauri Temple Premises"
  },
  {
    src: "https://indiano.travel/wp-content/uploads/2022/04/Maa-Mangla-Gauri-Temple.jpg",
    caption: "Maa Mangla Gauri Idol and Shrine"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}

const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 24.7810;
const lon = 84.9996;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

document.addEventListener("DOMContentLoaded", () => {
  const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  listenBtn.addEventListener("click", () => {
    if (!isSpeaking) {
      utterance = new SpeechSynthesisUtterance(textToRead);
      synth.speak(utterance);
      isSpeaking = true;
      isPaused = false;
      listenBtn.textContent = "â¸ï¸ Pause";

      utterance.onend = () => {
        isSpeaking = false;
        isPaused = false;
        listenBtn.textContent = "ğŸ”Š Listen";
      };
    } else if (!isPaused) {
      synth.pause();
      isPaused = true;
      listenBtn.textContent = "â–¶ï¸ Resume";
    } else {
      synth.resume();
      isPaused = false;
      listenBtn.textContent = "â¸ï¸ Pause";
    }
  });

  resetBtn.addEventListener("click", () => {
    synth.cancel();
    isSpeaking = false;
    isPaused = false;
    listenBtn.textContent = "ğŸ”Š Listen";
  });

  // Start image slider
  showSlide(currentIndex);
  startAutoSlide();
});

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
