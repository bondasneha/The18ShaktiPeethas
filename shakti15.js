const contentData = {
    history: `
        <h3>History</h3>
         <p>The temple is believed to have been built by a king who tried to ascertain from where a female emerged and drank the milk of the cows in those days. Taking this as Divine intervention, he began searching and upon pinpointing the exact place, he began construction of the temple. Priests were appointed to conduct the Pujas and take care of the temple. </p>
            <p>It is believed that the Pandavas also carried out some renovation work in the temple. The Mughal Emperor Akbar also visited the temple and tried in vain to douse the flames. He immediately submitted to the Goddess and presented a Golden Umbrella as a mark of his respect. </p>
            <p>The great Maharaja Ranjit Singh of Punjab visited the temple in the year 1809 and gifted a gilt roof for the temple. His son, Kharak Singh also gifted a pair of silver plated folding doors to the temple.</p>
            <p>The Jwalamukhi temple is regarded as one of the Shakti Peeths which tells the story of Sati, the consort of Shiva. When her father Daksha organized a yagna, he deliberately rebuked Shiva as an ascetic and one unworthy of his daughter. </p>
            <p>Sati took this a personal affront and jumped into the sacrificial fire, taking her own life. Shiva was enraged and placing Sati’s body on his shoulders, he commenced the Tandav or divine dance of destruction. </p>
            <p>To stop Shiva from destroying the Universe and creation, Lord Vishnu severed the dead body into several pieces with his discus and the places where these pieces fell are called Shakti Peeths. The Jwalamukhi temple was constructed at the spot where Sati’s tongue is said to have fallen.</p>
        <div align="center">
              <P><b>Appellation:</b> Jwalamukhi Pitham.</P>
            <P><b>Part of body fallen:</b> Head.</P>
            <P><b>Name of shakti:</b> Maa Jwalamukhi(Jwalamukhi Devi).</P>      
                </div>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <P> People from the entire world visit this unique temple to obtain the blessings of the divine Mother and many believe that offering prayers here will wipe out their sins. It is said that the flames from the pits purifies the soul and leads to the end of struggles, while also paving the path for happier days to come.</P>
                <p> The building of the temple has a gilt dome and silver plated folding doors.</p>
               <p> Within it is a square pit from which dancing flames leap out and this has been happening since time immemorial.</p>
                <p> The flames represent the Goddess and symbolize her power as the all-consuming Shakti (energy).</p>
                <p> The unique feature of this temple is the absence of an Idol or Image which transcends all Earthly perceptions of Divine Beings by manifesting in the basic element of Energy itself.</P>
                <p> The Jwalamukhi Temple is a famous Hindu Shrine located in Himachal Pradesh, India. dedicated to Goddess Jwalamukhi who is considered the deity of the ‘flaming mouth’. 
                   <p> Jwalamukhi means ‘Volcano’ and hence the temple does not have an idol or Image, but only a flaming pit representing the deity. </p>
                    <p> There is a three square foot pit, with a pathway developed all around it which leads to a hollowed rock over a fissure in the ground from which flames leap out.</p>
                    <p> This fissure is regarded as the mouth of the Mahakali and in all there are nine fissures which symbolize the nine forms of the Divine Mother in various Avatars. </p>
                   <p> The flames leaping out from the ground are believed to represent the deity and hence, she is revered as the Goddess of Light. </p>
                   <p> Legend has it that this is the place where Goddess Sati’s tongue fell to the Earth when Lord Vishnu cut apart her body with his Sudarshan Chakra. </p>
                    <p> She is revered as Maa Durga who manifested here as the flames that leap through the fissures in the rock.</p>
                    <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
                `,
    festivals: `
        <h3>Festivals</h3>
        <p> Navaratri</p>
        <p> Aadi and Aippasi Pooram</p>
        <p> Sankara Jayanthi and Vasanta Utsavam in the Tamil month of Vaikasi.</p>
        <p> All Fridays are considered sacred, though the Fridays in the Tamil months of Adi (mid-July to mid-August) and Thai (mid-January to mid-February) are celebrated. </p>        
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location: Jwalamukhi,Himachal Pradesh<br>✈️ Nearest Airports: Lal Bahadur Shastri International Airport (221 KM), Singrauli Airport (20KM) <br>🚉 Railway Station:  Murzapur railways station (198 KM), Singrauli Railway Station (19 KM) <br> Vindhyanagar (10 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>🕘  6:00 AM - 4:00 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <center><p>Click down button to open official website of Jwalamukhi Devi Temple</p></center>
      <center>
  <a href="https://jawalaji.in/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Chamundeshwari Devi Temple Website
    </button>
  </a>
</center>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
   <P><b>Prasadam:</b>prasadam typically includes items such as cooked rice, dal (lentils), vegetable curry, puri (fried bread), kheer (rice pudding), and sometimes special sweets like ladoo or peda. These prasadams are offered to the goddess Jwalamukhi during puja rituals and then distributed to devotees as blessings.</P>
            <P> Annadanam Seva at Jwalamukhi Temple provides meals or prasadam to devotees as service and charity, fostering community and fulfilling the sacred duty of feeding the hungry people.</P>
               <P> Toilets and restrooms are there for people near the Temple and also at various locations in the town.</P>
                <P> Parking centres at numerous locations.</P>
                <P> Drinking-Water centres are there.</P>
                <P> A homoeopathic clinic is there for travellers where cost-free medical check-ups and medications had provided</P>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <P> The dress code for Jwalamukhi Temple may vary, but generally, it is advisable to dress modestly and respectfully. </P>
                <P> Visitors are often required to cover their heads, remove their shoes, and wear attire that covers their shoulders and knees. </P>
                <P> It had recommended inquiring about any specific dress guidelines or requirements before visiting the Temple to ensure you had appropriately dressed.</P>
                <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍Jwalamukhi,Himachal Pradesh</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1Lqjt5K5iPr8Zkxl5y5ecLbsn8X4JRQ8&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//31.8753944,76.3240824/@31.8753678,76.2416811,12z?entry=ttu&g_ep=EgoyMDI1MDYyMi4wIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750252948731!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJREczLWp6ekFF!2m2!1d31.875360783486!2d76.32427589770391!3f336.0583004100277!4f7.7156095651503875!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/UOW_oK42LWI?si=hTWPLWZqPPZ5RhDm&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
    textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
    const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://www.astroved.com/astropedia/assets/images/temples/jwalamukhi.jpg",
    caption: "Jwalamukhi Temple - AstroVed"
  },
  {
    src: "https://static.toiimg.com/photo/60508867.cms",
    caption: "Temple Flame"
  },
  {
    src: "https://live.staticflickr.com/386/31963938261_63bdf2e4d7_b.jpg",
    caption: "Jwalamukhi Inner Sanctum"
  },
  {
    src: "https://www.nativeplanet.com/img/2018/01/58-1516703141.jpg",
    caption: "Jwalamukhi Temple Entrance - Native Planet"
  },
  {
    src: "https://myoksha.com/wp-content/uploads/2016/04/Jwalamukhi-Temple.jpg",
    caption: "Temple View"
  },
  {
    src: "https://famoustemplesofindia.com/wp-content/uploads/2023/09/Jwalamukhi-Temple-Shaktinagar-1-1200x900.jpg",
    caption: "Jwalamukhi Temple - Shaktinagar View"
  },
  {
    src: "https://media-cdn.tripadvisor.com/media/photo-s/1a/8d/6a/c8/jwalamukhi-temple-us.jpg",
    caption: "Jwalamukhi Temple - Myoksha"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 31.8754;
const lon =76.3186;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
