const contentData = {
    history: `
        <h3>History</h3>
        <p>The history goes back to the period of Mahabharata. When Pandavas were in exile, they spent around 14 years in the forest. As part of this, they were required to stay hidden for a year. If they get caught, they are required to repeat the entire tenure.</p>
        <p>One day, Devi Parvati came into their dream. She asked them to build the temple. So, Pandavas honoured that. They built the mighty temple in the middle of the forest in no time which surprised the goddess. That also pleased Maa Parvati and she blessed them. As per her boon, no one could find them during the tenure of their exile.</p>
        <p>The temple-complex originally consisted of three similar shrines built in a row all facing west. Of these, the central and the southern shrines are preserved in full, and the rest of the structures are preserved only on plan. The maha-mandapa, varsha-mandapa and gopura are situated in front of these three shrines and these three shrines are surrounded by sixteen shrines of additional parivara devatas.</p>
        <div align="center">
            <p><b>Appellation:</b> Moola Pitham.</p>
            <p><b>Part of body fallen :</b> Left hand.</p>
            <p><b>Name of shakti :</b> Ekavira Devi(Ekaveenika Devi).</p>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        </div>
    `,
    significance: `
        <h3>Significance</h3>
        <p>ÂŸ It is believed that the goddess has magical powers.</p>
        <p>ÂŸ The temple gains its importance in the Indian culture.</p>
        <p>ÂŸ The temple is a prime spot of worship for the Aagri and Koli people. </p>
        <p>ÂŸ The Ekvira Devi Temple holds great religious and cultural significance for the people of Maharashtra and beyond.</p>
        <p>ÂŸ Devotees believe that the Goddess Ekvira can grant wishes and blessings, and visiting the temple is considered a means of seeking her divine intervention.</p>
        <p>ÂŸ Ekvira Devi temple is located in Lonavala, Western Maharashtra, India, close to the Karla Caves.</p> 
        <p>ÂŸ It is a prominent religious temple, particularly for the Koli community in Maharashtra.</p>
        <p>ÂŸ To obtain the blessings of Ekvira Devi, who is revered as a goddess of protection and wish fulfilment, devotees travel to the temple.</p>
        <p>ÂŸ The temple, which is housed in a structure resembling a cave, is a significant place with extraordinary religious importance.</p>
        <p>ÂŸ It is regarded to be a form of the goddess Renuka.She isthmus kuladevi of the koli people every year kolis pay respect to Ekavira and celebrate the festival in Karla Caves.</p>
        <p>ÂŸ The Ekvira Temple is a revered place for the local fishermen community. The deity that occupies pride of place here is the Aai Ekvira, the tribal Goddess worshiped by the Agri community.</p> 
        <p>ÂŸ It is believed that the temple was built by the Pandavas when they visited this part during their 14-year long exile.</p>
        <p>ÂŸ The temple is on a hill. One needs to ascend around 500 steps to reach the temple. It is surrounded by the Karla caves, which are now protected by the Archeological department.</p>
        <p>ÂŸ  While the main deity is Ekvira, she is accompanied by a murti of Jogesvari Devi. Ekvira is a Hindu goddess, regarded to be a form of the goddess Renuka. She is the kuladevi of the Koli people.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p>ÂŸ The devotees throng the temple on all occasions of Navaratri and Chaitra Navratra to worship and celebrate.</p>
        <p>ÂŸ Chytra Palkhi Festival (March, April).</p>
        <p>ÂŸ Gudi Padwa,Mahashivratri,Akshaya Tritiya,Gauri Pujan, Durga Ashtami, and Palkhi Processions.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
        `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>ğŸ“ Location: Mahur,Maharashtra<br>âœˆï¸ Nearest Airports: Pune International Airport (62 KM)<br>ğŸš‰ Railway Station: Pune railway station (59 KM) <br>ğŸ›£ï¸ Road ways: Aamby Valley City (35 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <p>ğŸ•˜ 6:00 AM - 8:00 PM</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>prasadam typically includes items like cooked rice, sweet dishes such as sheera (a semolina-based sweet), ladoo (sweet balls), and fruits. Additionally, some temples may offer special regional delicacies or items unique to their local traditions as prasadam.</p>
      <P>ÂŸ No facilities available. </P>
      <p>ÂŸ There are several accommodation options near the temple for devotees, such as lodges, hotels, and guest houses.</P>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p>ÂŸ For men the dress code is Shirt & Trouser, Dhoti or Pyjamas with upper cloth. </p>
      <p>ÂŸ For women the preferred dress code is saree or half-saree with blouse or chudidhar with pyjama and upper cloth.</p>
      <p>ÂŸ Shorts, mini-skirts, middies, sleeveless tops, low-waist jeans and short-length T-shirts are not allowed.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">ğŸ”Š Listen</button>
      <button id="resetBtn">ğŸ” Reset</button>
    </div>
      `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">ğŸ“Mahur,Maharashtra</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1F0NNeuMGjt4Y34ppJK-5ogMLJ8IgiHc&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">ğŸ—ºï¸ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//19.8439002,77.8585777/@19.8438813,77.776176,12z/data=!3m1!4b1?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      ğŸ›£ï¸ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750249316471!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJQzA5c0N5OFFF!2m2!1d19.84097943530365!2d77.92192329351529!3f125.19093507110118!4f-3.4352230933841525!5f0.7820865974627469" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/dC3nFrzzgN0?si=UzIQUUzZzNWng9cr&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
      const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "ğŸ”Š Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "â–¶ï¸ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "â¸ï¸ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "ğŸ”Š Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "ğŸ”Š Listen";
  }
const sliderImages = [
  {
    src: "https://4.bp.blogspot.com/-b-_tKiJWDUo/U2KIOBHwaFI/AAAAAAAAGnM/_8u3OAjL6a0/s1600/Karla+caves+040.jpg",
    caption: "Ancient Structure of Karla Caves and Ekvira Devi Temple"
  },
  {
    src: "https://i.pinimg.com/564x/a1/d1/3a/a1d13ab7de59e53cc790260f1a6d0c1a.jpg",
    caption: "Devotees Climbing to Ekvira Temple through the Hill Path"
  },
  {
    src: "https://upload.wikimedia.org/wikipedia/commons/0/0e/Adidhskti_Mata_Ekvira_Devi_Temple.jpg",
    caption: "Adi Shakti Ekvira Devi Temple - Sanctum Exterior"
  },
  {
    src: "https://thumbs.dreamstime.com/b/buddhist-site-entrance-gate-karla-caves-ekvira-devi-temple-near-lonavala-may-buddhist-site-entrance-gate-karla-caves-155505515.jpg",
    caption: "Entrance Gate to Karla Caves and Ekvira Devi Shrine"
  },
  {
    src: "https://4.bp.blogspot.com/-lBCO3qEpcOU/WrjfaiMkSWI/AAAAAAAAD9U/r_I2CApB9qYEltcVbzqmh3LRzkO6u2c6wCEwYBhgL/s1600/images%25288%2529.jpg",
    caption: "Devotees Offering Prayers Inside the Temple Premises"
  },
  {
    src: "https://media-cdn.tripadvisor.com/media/photo-s/15/5b/d7/56/meditation-hall.jpg",
    caption: "Stone Pillars and Meditation Hall in Karla Caves"
  },
  {
    src: "https://e1.pxfuel.com/desktop-wallpaper/858/281/desktop-wallpaper-ekvira-mandir-karla-caves.jpg",
    caption: "Scenic View of Ekvira Mandir and Karla Caves Hillside"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) â†’ jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) â†’ jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";


const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df'; // Replace with your real API key

// Kamakhya Temple (Guwahati)
const lat = 19.98;
const lon = 78.17;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // âœ… Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
