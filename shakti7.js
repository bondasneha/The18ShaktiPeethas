const contentData = {
    history: `
        <h3>History</h3>
        <p>The temple of the goddess Mahalakshmi was built by Karnadeva in 634 CE Chalukya reign.Mounted on a stone platform, the murti of the crowned goddess is made of gemstone and weighs about 40 kilograms. The image of Mahalakshmi carved in black stone is 3 feet in height. </p>
        <p>The temple belongs architecturally to the Chalukya empire and was first built in the 7th century.The temple is referred to in multiple Puranas. There is evidence to show that the Konkan king Kamadeo, Chalukyas, Shilahara, Yadavas of Devagiri dynasties visited this city.</p>
        <p>In 109 CE, Karnadeo cut off the jungle and brought the temple to light. The existence goes back to the 8th century, according to Bhandarkar and Khare.Itihasa Chakra indicates that the temple dates back to Mahājanapadā times. In the 8th century, the temple sank down due to an earthquake. In the 9th century, Gandavadix (King) extended the temple by building Mahakali Mandir. </p>
        <p>During 1178–1209, in the reign of Raja Jaysing and Sindhava, South gate and Atibaleshwar Temple were built. In 1218, Yadav king Tolum built Mahadwar and offered jewels to Devi. Further, Shilaharas built Maha Sarasvati Mandir. He being a Jain, got 64 idols carved.</p>
        <p>The temple of the goddess Mahalakshmi was built by Karnadeva in 634 CE Chalukya reign.Mounted on a stone platform, the murti of the crowned goddess is made of gemstone and weighs about 40 kilograms. The image of Mahalakshmi carved in black stone is 3 feet in height. </p>
        <p>The temple belongs architecturally to the Chalukya empire and was first built in the 7th century.The temple is referred to in multiple Puranas. There is evidence to show that the Konkan king Kamadeo, Chalukyas, Shilahara, Yadavas of Devagiri dynasties visited this city.</p>
        <p>In 109 CE, Karnadeo cut off the jungle and brought the temple to light. The existence goes back to the 8th century, according to Bhandarkar and Khare.Itihasa Chakra indicates that the temple dates back to Mahājanapadā times. In the 8th century, the temple sank down due to an earthquake. In the 9th century, Gandavadix (King) extended the temple by building Mahakali Mandir. </p>
        <p>During 1178–1209, in the reign of Raja Jaysing and Sindhava, South gate and Atibaleshwar Temple were built. In 1218, Yadav king Tolum built Mahadwar and offered jewels to Devi. Further, Shilaharas built Maha Sarasvati Mandir. He being a Jain, got 64 idols carved.</p>
        <div align="center">
          <p><b>Appellation:</b> Shri Pitham.</p>
          <p><b>Part of body fallen :</b> Eye.</p>
          <p><b>Name of shakti :</b> Aai Ambabai(Mahalakshmi Devi).</p>
        </div>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    significance: `
        <h3>Significance</h3>
        <p> The Kolhapur peetha is of special religious significance, being one of the six places where it is believed one can either obtain salvation from desires or have them fulfilled. </p>
        <p> The temple takes its name from Mahalakshmi, the consort of Vishnu, and it is believed that the divine couple reside in the area.</p>
        <p> It is dedicated to Mahalakshmi the central deity of Devi Mahatmyam. </p>
        <p> The Mahalaxmi temple contains images of the Tridevi goddesses Mahakali, Mahalakshmi, and Mahasaraswati. All three images are adorned with nose rings, gold bangles and pearl necklaces.</p>
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
        `,
    festivals: `
        <h3>Festivals</h3>
        <p>The most important festivals held at Mahalakshmi Temple, Kolhapur with lots of joy and enthusiasm are:<br> Kirnotsav,<br>  Rathotsav,<br>  Lakshmi Puja,<br> Navratri,<br> Diwali,<br> Lalita Panchami,<br> Varalakshmi Vratham.</p>        
        <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    howtoreach: `
      <h3>How to Reach</h3>
      <p>📍 Location: Kolhapur,Maharashtra<br>✈️ Nearest Airports: Chhatrapati Rajaram Maharaj Airport (11 KM)<br>🚉 Railway Station:  Kolhapur railway station (3.1 KM) <br>🛣️ Road ways: kagal (21 KM)</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    timings: `
      <h3>Visiting Hours</h3>
      <center><p>🕘 6:00 AM –9:00 PM</p></center>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    bookings: `
      <h3>Link for Bookings</h3>
      <p>Click down link to open official website of Mahalakshmi Devi Temple</p>
      <center>
  <a href="https://mahalakshmi-temple.com/" target="_blank" style="text-decoration: none;">
    <button style="
      background-color:rgb(120, 94, 136);
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;">
      Visit Mahalakshmi Temple Website
    </button>
  </a>
</center>
            <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
    `,
    foodaccom: `
      <h3>Food and Accomodation</h3>
      <p><b>Prasadam:</b>The prasadam served at this temple typically includes items such as ukadiche modak (steamed sweet dumplings), coconut barfi, peda (a type of sweet made from condensed milk), various types of ladoo (sweet balls), and sometimes savory snacks like chivda or kachori. These prasadams are considered sacred and are offered to the goddess Mahalakshmi before being distributed to devotees as blessings.</p>
      <p>Shree Mahalaxmi Devasthan offers accommodation to the devotees who come from other sates to pay their prayers and devotion to the Goddess Mahalaxmi. Rooms are available at an affordable rate with all the basic amenities for a better experience. Rooms are clean, and furnished with the bed, table, chair, and mirror. Devasthan has two types of rooms AC(Air conditioner) and Non-AC (Without air conditioner). Devotees can choose the rooms as per their requirements and can stay for days. Since rooms are within the premise of the temple, one can visit the temple anytime they wish to and offer prayers.</p>
      <p> Free food facility for devotees available.</p>     
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    dress: ` 
      <h3>Dressing & Restrictions</h3>
      <p> Shorts, mini-skirts, middies, sleeveless tops, low-waist jeans and short-length T-shirts are not allowed.</p>
      <p> Wear appropriate clothing when visiting the temple.</p>
      <p> Mobile phones are allowed into the temple premises, however you are not supposed to click pictures of the idol or the temple premise.</p>
      <div style="margin-top: 20px; text-align: center;">
      <button id="listenBtn">🔊 Listen</button>
      <button id="resetBtn">🔁 Reset</button>
    </div>
      `,
    location: ` 
    <h3 style="padding-left:55px;">Location</h3>
    <p style="text-align: center;">📍Kolhapur,Maharashtra</p>
    <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/d/u/0/edit?mid=1S_vJ99dPqpdPIJEFWpfZpquvfsQ2CEQ&usp=sharing', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">🗺️ View Location on Map </button>
  </div>
  <p style="text-align: center;">Press down to get route from your current location</p>
  <div style="text-align: center; margin-top: 15px;">
    <button onclick="window.open('https://www.google.com/maps/dir//16.6948626,74.222803/@16.6948463,74.1404012,12z?entry=ttu&g_ep=EgoyMDI1MDYyMy4yIKXMDSoASAFQAw%3D%3D', '_blank')" style="background-color: #4e3ec8; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 16px;">
      🛣️ Route
    </button>
  </div>
    `,
    vr:`
    <iframe src="https://www.google.com/maps/embed?pb=!4v1750248925803!6m8!1m7!1sCAoSF0NJSE0wb2dLRUlDQWdJRHVfODNpNWdF!2m2!1d16.69493895889635!2d74.22305307210259!3f317.5980989960176!4f22.98429330237947!5f0.4000000000000002" width="800px" height="500px" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    `,
    youtube:`
    <iframe width="800" height="500" src="https://www.youtube-nocookie.com/embed/RZGzre6iH34?si=2Qr0OkCteR43XDVg&amp;controls=0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
    `
  };

  function showPopup(key) {
    document.getElementById('popupText').innerHTML = contentData[key];
    document.getElementById('popup').style.display = 'flex';
     textToRead = Array.from(document.querySelectorAll('#popupText p, #popupText h3'))
                    .map(el => el.innerText)
                    .join(' ');
      const listenBtn = document.getElementById("listenBtn");
  const resetBtn = document.getElementById("resetBtn");

  if (listenBtn) {
    listenBtn.addEventListener("click", () => {
      if (!isSpeaking) {
        utterance = new SpeechSynthesisUtterance(textToRead);
        synth.speak(utterance);
        isSpeaking = true;
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";

        utterance.onend = () => {
          isSpeaking = false;
          isPaused = false;
          listenBtn.textContent = "🔊 Listen";
        };
      } else if (!isPaused) {
        synth.pause();
        isPaused = true;
        listenBtn.textContent = "▶️ Resume";
      } else {
        synth.resume();
        isPaused = false;
        listenBtn.textContent = "⏸️ Pause";
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener("click", () => {
      synth.cancel();
      isSpeaking = false;
      isPaused = false;
      if (listenBtn) listenBtn.textContent = "🔊 Listen";
    });
  }
  }

  function closePopup() {
    document.getElementById('popup').style.display = 'none';
    window.speechSynthesis.cancel();
  isSpeaking = false;
  isPaused = false;
  document.getElementById("listenBtn").textContent = "🔊 Listen";
  }
const sliderImages = [
  {
    src: "https://th.bing.com/th/id/OIP.qfd8jDVLLdcFgk8l3lATTgHaJ1?rs=1&pid=ImgDetMain&cb=idpwebpc2",
    caption: "Devotees Performing Pujas at Mahalakshmi Temple"
  },
  {
    src: "https://www.holidify.com/images/cmsuploads/compressed/800px-Mahalaxmi_Temple_Kolhapur_20200121170459.jpg",
    caption: "Navaratri Celebrations at Mahalakshmi Temple"
  },
  {
    src: "https://im.whatshot.in/img/2021/Jul/49789355-330848164430745-1970383257119752192-n-cropped-1626777504.jpg",
    caption: "Ancient Architecture of Kolhapur Mahalakshmi Temple"
  },
  {
    src: "https://1.bp.blogspot.com/-d5I05ZFv9mw/XQcvtu2S5oI/AAAAAAAABWQ/tNl32bhODUYAX5KqzPzTMAPHlbDTJxWUgCLcBGAs/s640/Untitled4.png",
    caption: "Illuminated Temple View during Festivities"
  },
  {
    src: "https://shreesarvasiddhi.com/wp-content/uploads/2021/07/Pujas-at-Mahalakshmi-temple_-Kolhapur-600x600-1.jpg",
    caption: "Navaratri Celebrations at Mahalakshmi Temple"
  },
  {
    src: "https://d3k1i85mml78tf.cloudfront.net/Communities/1704728578972_dp_cover_5.jpg",
    caption: "Panoramic View of Kolhapur Mahalakshmi Temple Complex"
  },
  {
    src: "https://youtellme.ai/wp-content/uploads/2021/12/Mahalaxmi-Temple_Interior_DSC02270_e.jpg",
    caption: "Interior of the Mahalakshmi Shrine"
  }
];
const sliderTrackHalf = document.getElementById("sliderTrackHalf");
let halfIndex = 1;
let autoSlideInterval;
const slideWidth = 70 + 2; // 70% + 2% gap

function buildHalfSlider() {
  sliderTrackHalf.innerHTML = '';

  // Clone last slide first for seamless loop
  const lastClone = createSlide(sliderImages[sliderImages.length - 1]);
  sliderTrackHalf.appendChild(lastClone);

  sliderImages.forEach((imgObj, i) => {
    const slide = createSlide(imgObj);
    if (i === 0) slide.classList.add("active");
    sliderTrackHalf.appendChild(slide);
  });

  // Clone first slide last
  const firstClone = createSlide(sliderImages[0]);
  sliderTrackHalf.appendChild(firstClone);

  setSlidePosition(halfIndex);
}

function createSlide(imgObj) {
  const slideDiv = document.createElement("div");
  slideDiv.className = "slide-half";

  const img = document.createElement("img");
  img.src = imgObj.src;
  img.alt = imgObj.caption;

  const caption = document.createElement("div");
  caption.className = "slider-caption-half";
  caption.textContent = imgObj.caption;

  slideDiv.appendChild(img);
  slideDiv.appendChild(caption);
  return slideDiv;
}
function setSlidePosition(index) {
  const slides = document.querySelectorAll('.slide-half');
  const wrapper = document.querySelector('.slider-wrapper-half');
  const track = document.querySelector('.slider-track-half');

  if (!slides[index]) return;

  const slide = slides[index];
  const slideWidth = slide.offsetWidth + 20; // 20px = gap
  const centerOffset = (slide.offsetLeft + slideWidth / 2) - (wrapper.offsetWidth / 2);

  track.style.transform = `translateX(-${centerOffset}px)`;

  // Reset all slide classes
  slides.forEach((s, i) => {
    s.classList.remove('active', 'prev');
    if (i === index) s.classList.add('active');
    if (i === index - 1) s.classList.add('prev');
  });
}


function scrollHalfSlider() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex >= sliderImages.length + 1) return; // prevent rapid clicks
  halfIndex++;

  setSlidePosition(halfIndex);

  sliderTrackHalf.addEventListener('transitionend', handleLoop, { once: true });
}

function handleLoop() {
  const slides = document.querySelectorAll('.slide-half');
  if (halfIndex === sliderImages.length + 1) {
    // Moved past last (cloned first) → jump to real first
    sliderTrackHalf.style.transition = "none";
    halfIndex = 1;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 10);
  }

  if (halfIndex === 0) {
    // Moved past first (cloned last) → jump to real last
    sliderTrackHalf.style.transition = "none";
    halfIndex = sliderImages.length;
    setSlidePosition(halfIndex);
    setTimeout(() => {
      sliderTrackHalf.style.transition = "transform 0.6s ease-in-out";
    }, 20);
  }
}

function startAutoSlide() {
  autoSlideInterval = setInterval(scrollHalfSlider, 2500);
}

function stopAutoSlide() {
  clearInterval(autoSlideInterval);
}

window.addEventListener("DOMContentLoaded", () => {
  buildHalfSlider();
  startAutoSlide();
});
function manualSlide(direction) {
  const slides = document.querySelectorAll('.slide-half');

  if (direction === 1) {
    // Next
    if (halfIndex >= slides.length - 1) return;
    halfIndex++;
  } else {
    // Previous
    if (halfIndex <= 0) return;
    halfIndex--;
  }

  setSlidePosition(halfIndex);
  stopAutoSlide();   // Optional: stop auto-slide when manually clicked
  startAutoSlide();  // Optional: restart after click
}


const apiKey = 'a20b221e9ef5baed6d9d0d37f7db90df';
const lat = 16.7032;
const lon = 74.2215;

const weatherIcon = document.getElementById("weatherIcon");
const modal = document.getElementById("weatherModal");
const closeBtn = document.querySelector(".close");

weatherIcon.addEventListener("click", () => {
  modal.style.display = "block";
  fetchWeather();
});

closeBtn.onclick = () => {
  modal.style.display = "none";
};

window.onclick = (e) => {
  if (e.target === modal) modal.style.display = "none";
};

function fetchWeather() {
  const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${apiKey}`;

  fetch(url)
    .then(res => res.json())
    .then(data => {
      document.getElementById("temp").textContent = data.main.temp;
      document.getElementById("condition").textContent = data.weather[0].description;
      document.getElementById("conditionIcon").src = `https://openweathermap.org/img/wn/${data.weather[0].icon}.png`;
    })
    .catch(() => {
      alert("Error fetching weather. Please check your API key.");
    });
}
let synth = window.speechSynthesis;
let utterance;
let isSpeaking = false;
let isPaused = false;
let textToRead = "";

const GEMINI_API_KEY = "AIzaSyAuv5e9GRI6VHzd1bUETHiRh18g4-bVyyk"; 
  function toggleChatbot() {
    const chatbot = document.getElementById('chatbotWindow');
    chatbot.style.display = chatbot.style.display === 'flex' ? 'none' : 'flex';
  }

  function appendMessage(sender, message) {
    const chat = document.getElementById('chatMessages');
    const msg = document.createElement('div');
    msg.className = 'message ' + (sender === 'user' ? 'user-message' : 'bot-message');
    msg.textContent = message;
    chat.appendChild(msg);
    chat.scrollTop = chat.scrollHeight;
  }

  function replaceLastBotMessage(newText) {
    const chat = document.getElementById('chatMessages');
    const messages = chat.querySelectorAll('.bot-message');
    if (messages.length > 0) {
      messages[messages.length - 1].textContent = newText;
    }
  }

  async function sendMessage() {
    const input = document.getElementById('userInput');
    const userMessage = input.value.trim();
    if (!userMessage) return;

    appendMessage('user', userMessage);
    input.value = '';
    appendMessage('bot', 'Typing...');

    try {
      const res = await fetch(
        `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
        {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            contents: [{ parts: [{ text: userMessage }] }]
          })
        }
      );

      const data = await res.json();
      console.log("Gemini response:", data);
      const botReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, no reply.";
      replaceLastBotMessage(botReply);
    } catch (err) {
      console.error("Gemini API error:", err);
      replaceLastBotMessage("Error getting response from Gemini.");
    }
  }
document.addEventListener("DOMContentLoaded", () => {
  const userButton = document.getElementById("userButton");
  const dropdown = document.getElementById("userDropdown");

  userButton.addEventListener("click", (e) => {
    e.stopPropagation(); // Prevent event bubbling
    dropdown.style.display = dropdown.style.display === "block" ? "none" : "block";
  });

  // Hide dropdown when clicking outside
  document.addEventListener("click", (e) => {
    if (!e.target.closest("#userMenu")) {
      dropdown.style.display = "none";
    }
  });
});
document.addEventListener("DOMContentLoaded", () => {
  const logoutBtn = document.getElementById("logoutBtn");

  logoutBtn.addEventListener("click", () => {
    // Optional: Clear session/local storage if used
    // localStorage.clear();

    // Redirect to homepage
    window.location.href = "login.html"; // ✅ Change if your filename is different
  });
});
firebase.auth().signOut().then(() => {
  window.location.href = "login.html";
}).catch((error) => {
  console.error("Logout failed:", error);
});
